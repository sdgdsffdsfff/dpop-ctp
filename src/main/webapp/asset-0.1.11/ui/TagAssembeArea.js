/*! 2015 Baidu Inc. All Rights Reserved */
define("ui/TagAssembeArea",["require","esui/lib","esui/main","./AttachTagBoxGroup","./TagBoxGroup","./TradeChoosePanel","esui/Label","esui/Panel","esui/Button","esui/TextBox","common/util","esui/InputControl","esui/painters","esui"],function(require){function e(){c.apply(this,arguments)}function t(e,t){d.each(t,function(t){e.classList.add(t)})}function i(e,i){var n=document.createElement(e);return t(n,i),n}function n(e){e.helper.clearDOMEvents(),e.helper.disposeChildren(),a(e,e.isAudit,e.third,e.tagedThird);var t=s(e,e.comment);l(e,e.isAudit),e.main.appendChild(t.node),e.childrenIndex.comment.appendTo(t.textContainer),o(e,e.tradeList),e.addEvent(),e.childrenIndex.tradePanel.toggle()}function r(e){var t=e.childrenIndex.tradeText,i=e.childrenIndex.beforeIcon,n=e.childrenIndex.beforeText;if(t.getText()===e.tagedThird)i.main.classList.remove("after-icon"),n.main.classList.remove("after-color");else i.main.classList.add("after-icon"),n.main.classList.add("after-color")}function a(e,n,r,a){var o=i("div",["single-operation-zone","form-field","trade-name-area"]),s=null,l=u.create("Label",{title:"行业分类",text:"行业分类："});l.main.classList.add("form-field-label"),l.appendTo(o);var h=u.create("Button",{content:"修改",skin:"link"});if(h.main.classList.add("operation-zone-button"),e.addChild(h,"modifyButton"),"true"===n&&a){var d=u.create("Label",{title:"前",text:"前"});d.main.classList.add("before-icon");var c=u.create("Label",{title:a,text:a});if(t(c.main,["operation-zone-tadeName","audit-without-float"]),r!==a)d.main.classList.add("after-icon"),c.main.classList.add("after-color");var f=i("div",["audit-trade-compare"]),p=u.create("Label",{title:"后",text:"后"});p.main.classList.add("before-icon"),s=u.create("Label",{title:r,text:r}),t(s.main,["operation-zone-tadeName","audit-without-float"]),p.appendTo(f),s.appendTo(f),h.appendTo(f),e.addChild(d,"beforeIcon"),e.addChild(c,"beforeText"),d.appendTo(o),c.appendTo(o),o.appendChild(f)}else s=u.create("Label",{title:r,text:r}),t(s.main,["operation-zone-tadeName"]),s.appendTo(o),h.appendTo(o);e.addChild(s,"tradeText"),e.main.appendChild(o)}function o(e,t){var n=u.create("Panel",{});n.main.classList.add("trade-list");var r=i("div",["trade-list-container"]),a=u.create("TradeChoosePanel",{datasource:t});e.addChild(n,"tradePanel"),e.addChild(a,"tradeList"),a.appendTo(r),n.main.appendChild(r),e.main.appendChild(n.main)}function s(e,t){var n=i("div",["single-operation-zone","comment-area"]),r=i("div",["form-field"]),a=u.create("Label",{title:"备注",text:"备注："});a.main.classList.add("form-field-label");var o=i("div",["form-field-value"]),s=u.create("TextBox",{width:250,title:"备注",mode:"textarea",height:25});return s.setValue(t),e.addChild(s,"comment"),a.appendTo(r),r.appendChild(o),n.appendChild(r),{node:n,textContainer:o}}function l(e,n){var r=i("div",["attach-tag-group"]),a=["attach-tagbox--group"],o={name:"attachTag",datasource:e.attachDatasource||[],value:e.attachValue||{},boxType:"radio"};if("true"===n&&e.tagedThird)o.originValue=e.attachOriginValue||{},a.push("audit-box-group");var s=u.create("TagBoxGroup",o);t(s.main,a),e.addChild(s,"attachTag"),s.appendTo(r),e.main.appendChild(r)}var h=require("esui/lib"),u=require("esui/main");require("./AttachTagBoxGroup"),require("./TagBoxGroup"),require("./TradeChoosePanel"),require("esui/Label"),require("esui/Panel"),require("esui/Button"),require("esui/TextBox");var d=require("common/util"),c=require("esui/InputControl");return h.inherits(e,c),e.prototype.type="TagAssembeArea",e.prototype.initOptions=function(e){var t={wuliaoId:"",isAudit:!1,third:null,tagedThird:null,tradeId:null,comment:"",tradeList:{},attachDatasource:[],attachValue:{},attachOriginValue:{},sample:""};if(d.extend(t,e),!t.rawValue&&!t.value)t.rawValue=[];this.setProperties(t)},e.prototype.addEvent=function(){var e=this.childrenIndex.modifyButton,t=this.childrenIndex.tradePanel,i=this.childrenIndex.tradeList,n=this.childrenIndex.comment;this.helper.addDOMEvent(e.main,"click",function(){if(this.fire("toggleTradePanel",{clickButton:e.main,tradePanel:t}),t.toggle(),this.tradeId&&6===this.tradeId.length)i.setRawValue(this.tradeId);else i.setRawValue(i.getDefaultValue())},this),n.on("input",function(e){this.comment=e.target.getValue()},this),this.helper.addDOMEvent(t.main,"click",function(e){e.stopPropagation()},this)},e.prototype.setProperties=function(e){if(!(!e.datasource&&!e.boxType||e.rawValue||e.value||this.rawValue&&this.rawValue.length))e.rawValue=[];var t=c.prototype.setProperties.apply(this,arguments);if(t.hasOwnProperty("rawValue"))this.fire("change")},e.prototype.repaint=require("esui/painters").createRepaint(c.prototype.repaint,{name:["datasource"],paint:n},{name:"rawValue",paint:function(e,t){t=t||[]}}),e.prototype.getRawValue=function(){return{comment:this.childrenIndex.comment.getValue(),tradeId:this.tradeId,tag:this.childrenIndex.attachTag.getRawValue(),third:this.third,sample:this.sample}},e.prototype.hideTradePanel=function(){var e=this.childrenIndex.tradePanel,t=this.childrenIndex.tradeText,i=this.childrenIndex.tradeList;if(i.getRawValue()&&!e.isHidden()){if(this.tradeId=i.getRawValue(),this.third=i.getContent(),t.setText(i.getContent()),t.setTitle(i.getContent()),"true"===this.isAudit&&this.tagedThird)r(this);e.hide(),this.fire("changeTrade",{tradeId:this.tradeId,id:this.wuliaoId})}},e.prototype.getAllNeedData=function(){var e=this.childrenIndex.attachTag;return{id:this.wuliaoId,isAudit:this.isAudit,third:this.third,tradeId:this.tradeId,tagedThird:this.tagedThird,comment:this.comment,datasource:e.datasource,value:e.getRawValue(),originValue:e.originValue,sample:this.sample}},e.prototype.getTagDatasource=function(){return this.childrenIndex.attachTag.datasource},e.prototype.setTagDatasource=function(e){this.childrenIndex.attachTag.datasource=e,this.childrenIndex.attachTag.refresh()},e.prototype.setRawValue=function(e){var t=this.childrenIndex.tradeText;if(e.comment)this.childrenIndex.comment.setValue(e.comment),this.comment=e.comment;if(e.tradeId)this.tradeId=e.tradeId;if(e.third)if(this.third=e.third,t.setText(e.third),t.setTitle(e.third),"true"===this.isAudit&&this.tagedThird)r(this);if(e.tag)this.childrenIndex.attachTag.setRawValue(e.tag);if(e.sample)this.sample=e.sample},require("esui").register(e),e});