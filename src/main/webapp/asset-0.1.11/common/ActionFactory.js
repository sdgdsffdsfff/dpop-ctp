/*! 2015 Baidu Inc. All Rights Reserved */
define("common/ActionFactory",["require","common/util","er/Deferred","eoo"],function(require){var e=require("common/util"),t=require("er/Deferred"),i={};i.constructor=function(e,t){t=t||{},this.actionModule=e,this.entityName=t.entityName||e.split("/")[0],this.backendEntityName=t.backendEntityName||this.entityName,this.noSchema=t.noSchema||!1},i.getBaseModuleName=function(){return this.actionModule.replace(/\/[^\/]*$/,"")},i.getModules=function(){var e=this.getBaseModuleName();return[this.actionModule,this.actionModule+"Model",this.actionModule+"View",e+"/Data","common/RequestStrategy","common/GlobalData","common/session"]},i.getViewName=function(t){var i=e.compact(t.url.toString().split("/")),n=i[i.length-1];if("create"===n||"update"===n)i[i.length-1]="form";return e.map(i,e.dasherize).join("-")},i.createRuntimeAction=function(i){var n=this.getModules();return t.require(n).then(e.bind(this.buildAction,this,i))},i.buildAction=function(){var e=arguments[0],t=arguments[1],i=arguments[2],n=arguments[3],a=arguments[4],r=arguments[5],o=arguments[6],s=arguments[7],l=new t;l.model=new i;var h=new a,d=new r(this.entityName,this.backendEntityName);if(h.setRequestStrategy(d),l.model.setData(h),l.model.setGlobalData)l.model.setGlobalData(o.getInstance());if(l.view=new n,l.view.name=this.getViewName(e),l.setSession)l.setSession(s);return l};var n=require("eoo").create(i);return n});