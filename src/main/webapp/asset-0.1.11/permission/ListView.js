/*! 2015 Baidu Inc. All Rights Reserved */
define("permission/ListView",["require","common/util","tpl!b1c6f6b6.tpl.html","./enum","esui/Table","common/ListView","eoo"],function(require){function e(e){var t=r.getAliasFromValue(e);return t.indexOf("inner")}function t(e){var t=n.findWhere(this.model.getStatusTransitions(),{statusName:e.name});if("click"===e.triggerType)if(t){var r={id:parseInt(e.args),status:t.status};this.fire("modifystatus",r)}else if("modify"===e.name){var a=e.args,o=i.call(this,a),s={url:o};this.popDrawerAction(s).show()}}function i(e){var t,i=this.model.get("url").getPath(),n=i.lastIndexOf("/");if(e.indexOf("inner")>=0)t=i.substring(0,n+1)+"innerUpdate~"+e;else t=i.substring(0,n+1)+"outerUpdate~"+e;return t}var n=require("common/util");require("tpl!b1c6f6b6.tpl.html");var r=require("./enum").UserRole,a=require("./enum").FreezedState,exports={};exports.template="permissionList",exports.tableFields=[{title:"帐户名",field:"userName",sortable:!1,resizable:!1,width:30,stable:!0,content:function(e){return"<span>"+e.userName+"</span>"}},{title:"权限角色",field:"roleType",sortable:!1,resizable:!1,width:30,stable:!0,content:function(e){return"<span>"+r.fromValue(e.roleType).text+"</span>"}},{title:"密码",field:"password",sortable:!1,resizable:!1,width:40,stable:!0,content:function(e){return"<span>"+e.password+"</span>"}},{title:"创建日期",field:"addTime",sortable:!0,resizable:!1,width:40,stable:!0,content:function(e){var t=new Date(e.addTime);return n.formatTime(t)}},{title:"用户状态",field:"isFreezed",sortable:!0,resizable:!1,width:40,stable:!0,content:function(e){var t=require("esui/Table");if(e.status===a.noFreezed)return"<span>"+a.fromValue(e.status).text+"</span>";else if(e.status===a.freezed){var i={command:"thaw",args:e.id,className:"table-command-text",text:"已冻结"};return t.command(i)}}},{title:"操作",field:"operation",sortable:!1,resizable:!1,width:60,stable:!0,content:function(t){var i,n=require("esui/Table");if(e(t.roleType)>=0)i="id="+t.id+"&roleType="+t.roleType+"&userName="+t.userName+"&password="+t.password+"&inner=true";else i="id="+t.id+"&roleType="+t.roleType+"&userName="+t.userName+"&password="+t.password;var a=[{command:"modify",args:i,text:"更改"},{command:"remove",args:t.id,text:"删除"}];if(t.roleType===r.manager)a.shift();return n.operations(a)}}],exports.uiEvents={"table:command":t},exports.submitSearch=function(){var e=[];if(this.getSafely("innerMarker").checked)e.push(r.getValueFromAlias("innerMarker"));if(this.getSafely("innerAudit").checked)e.push(r.getValueFromAlias("innerAudit"));if(this.getSafely("outerMarker").checked)e.push(r.getValueFromAlias("outerMarker"));if(this.getSafely("outerAudit").checked)e.push(r.getValueFromAlias("outerAudit"));if(this.getSafely("manager").checked)e.push(r.getValueFromAlias("manager"));this.fire("searchAllKey",{roleType:e})},exports.updateFilterPanelStatus=function(){};var o=require("common/ListView"),s=require("eoo").create(o,exports);return s});