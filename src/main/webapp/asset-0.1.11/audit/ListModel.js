/*! 2015 Baidu Inc. All Rights Reserved */
define("audit/ListModel",["require","common/util","er/datasource","ub-ria/mvc/filterHelper","er/permission","./enum","er/Deferred","common/ListModel","eoo"],function(require){var e=require("common/util"),t=require("er/datasource"),i=require("ub-ria/mvc/filterHelper"),n=require("er/permission"),r=require("./enum").Status,exports={};exports.statusTransitions=[{status:0,statusName:"remove",command:"删除"}];var a="你确定要删除这些审核任务吗？该审核任务下的所有信息将被一并删除，删除后不可恢复。",o="你确定要删除该审核任务吗？该审核任务下的所有信息将被一并删除，删除后不可恢复。",s=r.toArray();s.unshift({text:"全部状态",value:"all"});var l={statuses:t.constant(s)},h={canBatchModify:t.constant(!0)};if(n.isAllow("outerAuditRole"))h={canBatchModify:t.constant(!1)};exports.constructor=function(){this.$super(arguments),this.putDatasource(h),this.putDatasource(l)},exports.prepare=function(){this.$super(arguments);var e=this.get("data");if(e.canCreateAudit=!1,e.canBatchDownload=!0,e.canBatchDelete=!1,n.isAllow("innerAuditRole")||n.isAllow("managerRole"))e.canCreateAudit=!0,e.canBatchDelete=!0;if(n.isAllow("outerAuditRole"))e.canBatchDownload=!1},exports.getRemoveAdvice=function(t){var i=require("er/Deferred"),n=this.get("entityDescription"),r=a;if(1===t.length)r=o;var s={message:e.template(r,{entityDescription:n})};return i.resolved(s)},exports.getQuery=function(){var e=this.get("beginTime"),t=this.get("endTime"),i={id:this.get("id"),beginTime:e,endTime:t,taskName:this.get("taskName"),addUser:this.get("addUser"),size:this.get("size"),keyword:this.get("keyword"),status:this.get("status"),order:this.get("order"),orderBy:this.get("orderBy"),page:this.get("page")||1};if(!i.status)i.status=this.getDefaultStatusValue();else if("all"===i.status)i.status="";return i},exports.getFilters=function(){var t,n;if(this.get("beginTime"))t=e.formatTime(new Date(parseInt(this.get("beginTime"))));if(this.get("endTime"))n=e.formatTime(new Date(parseInt(this.get("endTime"))));return{status:{value:this.get("status"),text:i.select.getText,datasource:this.get("statuses")},beginTime:{value:t,text:t},endTime:{value:n,text:n},id:{value:this.get("id"),text:this.get("id")},taskName:{value:this.get("taskName"),text:this.get("taskName")},addUser:{value:this.get("addUser"),text:this.get("addUser")}}};var d=require("common/ListModel"),u=require("eoo").create(d,exports);return u});