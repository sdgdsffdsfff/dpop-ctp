define("er/Action",["require","./util","./Deferred","./events","./locator","eoo","mini-event/EventTarget"],function(require){function e(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(!i.success)e.push(i)}return this.handleError(e)}var t=require("./util"),exports={};exports.constructor=function(){this.disposed=!1,this.initialize()},exports.initialize=t.noop,exports.context=null,exports.modelType=null,exports.viewType=null,exports.enter=function(i){this.context=i||{},this.fire("enter");var n=t.mix({},i&&i.args);if(this.model)this.model.fill(n);else this.model=this.createModel(n);if(this.fire("beforemodelload"),this.model&&"function"==typeof this.model.load){var a=this.model.load();return a.then(t.bind(this.forwardToView,this),t.bind(e,this))}else return this.forwardToView(),require("./Deferred").resolved(this)},exports.handleError=function(e){throw e},exports.createModel=function(e){if(this.modelType){var t=new this.modelType(e);return t}else return{}},exports.forwardToView=function(){if(this.disposed)return this;if(this.fire("modelloaded"),!this.view)this.view=this.createView();if(this.view){if(this.view.model=this.model,!this.view.container)this.view.container=this.context.container;this.fire("beforerender"),this.view.render(),this.fire("rendered"),this.initBehavior(),this.fire("entercomplete")}else{var e=require("./events");e.notifyError("No view attached to this action")}return this},exports.createView=function(){return this.viewType?new this.viewType:null},exports.initBehavior=t.noop,exports.filterRedirect=t.noop,exports.leave=function(){if(this.disposed)return this;if(this.disposed=!0,this.fire("beforeleave"),this.model){if("function"==typeof this.model.dispose)this.model.dispose();this.model=null}if(this.view){if("function"==typeof this.view.dispose)this.view.dispose();this.view=null}this.fire("leave"),this.destroyEvents()},exports.redirect=function(e,t){var i=require("./locator");i.redirect(e,t)},exports.reload=function(){var e=require("./locator");e.reload()},exports.back=function(e){var t=this.context&&this.context.referrer,i=t||e;if(i)this.redirect(i)};var i=require("eoo").create(require("mini-event/EventTarget"),exports);return i});