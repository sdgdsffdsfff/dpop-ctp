define("er/URL",["require","./util","eoo"],function(require){var e=require("./util"),exports={};exports.constructor=function(i,n,a){i=i||"/",n=n||"",a=a||"~",this.toString=function(){return n?i+a+n:i},this.getPath=function(){return i},this.getSearch=function(){return n};var o=null;this.getQuery=function(i){if(!o)o=t.parseQuery(n);return i?o[i]:e.mix({},o)}},exports.compare=function(e){if("string"==typeof e)e=t.parse(e);var i={},n=this.getPath(),a=e.getPath();if(n===a)i.path=!1;else i.path={key:"path",self:n,other:a};var o=this.getQuery(),r=e.getQuery(),s={},l=[],h=!1;for(var V in o)if(o.hasOwnProperty(V)){var U=o[V],m=r[V];if(U!==m){h=!0;var p={key:V,self:U,other:m};l.push(p),s[V]=p}}for(var V in r)if(r.hasOwnProperty(V)&&!o.hasOwnProperty(V)){h=!0;var p={key:V,self:void 0,other:r[V]};l.push(p),s[V]=p}return i.queryDifference=l,i.query=h?s:!1,i};var t=require("eoo").create(exports);return t.parse=function(i,n){var a={querySeparator:"~"};n=e.mix(a,n);var o=i.indexOf(n.querySeparator);if(o>=0)return new t(i.slice(0,o),i.slice(o+1),n.querySeparator);else return new t(i,"",n.querySeparator)},t.withQuery=function(i,n,a){i+="";var o={querySeparator:"~"};a=e.mix(o,a);var r=i.indexOf(a.querySeparator)<0?a.querySeparator:"&",s=t.serialize(n),l=i+r+s;return t.parse(l,a)},t.parseQuery=function(e){for(var t=e.split("&"),i={},n=0;n<t.length;n++){var a=t[n];if(a){var o=a.indexOf("="),r=0>o?decodeURIComponent(a):decodeURIComponent(a.slice(0,o)),s=0>o?!0:decodeURIComponent(a.slice(o+1));if(i.hasOwnProperty(r)){if(s!==!0)i[r]=[].concat(i[r],s)}else i[r]=s}else;}return i},t.serialize=function(e){if(!e)return"";var t="";for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(n)}return t.slice(1)},t.empty=new t,t});