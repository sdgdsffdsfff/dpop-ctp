!function(e){function t(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}function n(){this.raw=[],this.length=0}function i(){return"___"+M++}function a(e,t){var n=new Function;n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function r(e){return C[e]}function o(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function s(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,n){return t[n-0+1]})}function l(e){return e=e.replace(/^\s*\*/,""),s('gv({0},["{1}"])',o(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function h(e,t,n,i,a,r){for(var o=n.length,s=e.split(t),l=0,h=[],d=0,u=s.length;u>d;d++){var c=s[d];if(d){var m=1;for(l++;;){var p=c.indexOf(n);if(0>p){h.push(l>1&&m?t:"",c);break}if(l=i?l-1:0,h.push(l>0&&m?t:"",c.slice(0,p),l>0?n:""),c=c.slice(p+o),m=0,0===l)break}if(0===l)a(h.join("")),r(c),h=[]}else c&&r(c)}if(l>0&&h.length>0)r(t),r(h.join(""))}function d(e,t,n){var i,a=[],r=t.options,s="",u="",c="",m="";if(n)s="ts(",u=")",c=S,m=D,i=r.defaultFilter;return h(e,r.variableOpen,r.variableClose,1,function(e){if(n&&e.indexOf("|")<0&&i)e+="|"+i;var r=e.indexOf("|"),o=(r>0?e.slice(0,r):e).replace(/^\s+/,"").replace(/\s+$/,""),h=r>0?e.slice(r+1):"",p=0===o.indexOf("*"),f=[p?"":s,l(o),p?"":u];if(h){h=d(h,t);for(var V=h.split("|"),U=0,g=V.length;g>U;U++){var y=V[U];if(/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(y)){if(f.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3)f.push(",",RegExp.$3);f.push(")")}}}a.push(c,f.join(""),m)},function(e){a.push(c,n?o(e):e,m)}),a.join("")}function u(e,t){this.value=e,this.engine=t}function c(e,t){this.value=e,this.engine=t,this.children=[]}function m(e,t){var n=e.stack,i=t?n.find(function(e){return e instanceof t}):n.bottom();if(i){var a;do{if(a=n.top(),!a.autoClose)throw new Error(a.type+" must be closed manually: "+a.value);a.autoClose(e)}while(a!==i)}return i}function p(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(\s*master\s*=\s*([a-z0-9_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,c.call(this,e,t),this.contents={}}function f(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(\s*master\s*=\s*([a-z0-9_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,c.call(this,e,t),this.contents={}}function V(e,t){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,c.call(this,e,t)}function U(e,t){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,c.call(this,e,t)}function g(e,t){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,c.call(this,e,t)}function y(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,c.call(this,e,t)}function b(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,c.call(this,e,t)}function _(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,c.call(this,e,t)}function k(e,t){if(!/^\s*(\$\{[\s\S]+\})\s+as\s+\$\{([0-9a-z_]+)\}\s*(,\s*\$\{([0-9a-z_]+)\})?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,c.call(this,e,t)}function v(e,t){c.call(this,e,t)}function x(e,t){v.call(this,e,t)}function L(e,t){c.call(this,e,t)}function w(e,t){t.targetOrMaster=e;var n=t.engine,i=e.name,a=e instanceof p,r=a?"targets":"masters";if(n[r][i])switch(n.options.namingConflict){case"override":n[r][i]=e,a&&t.targets.push(i);case"ignore":break;default:throw new Error((a?"Target":"Master")+" is exists: "+i)}else n[r][i]=e,a&&t.targets.push(i)}function W(e,t){A[e]=t,t.prototype.type=e}function I(e){this.options={commandOpen:"<!--",commandClose:"-->",variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.masters={},this.targets={},this.filters=t({},K)}function X(e,t){function i(){if(p.length>0){var e=p.join(""),n=new u(e,t);if(n.beforeAdd(d),l.top().addTextNode(n),p=[],t.options.strip&&d.current instanceof c)n.value=e.replace(/^[\x20\t\r]*\n/,"");d.current=n}}function a(e){return e instanceof r}var r,o=t.options.commandOpen,s=t.options.commandClose,l=new n,d={engine:t,targets:[],stack:l},p=[];return h(e,o,s,0,function(e){var n=/^\s*(\/)?([a-z]+)\s*(:([\s\S]*))?$/.exec(e);if(n&&(r=A[n[2].toLowerCase()])&&"function"==typeof r){i();var h=d.current;if(t.options.strip&&h instanceof u)h.value=h.value.replace(/\r?\n[\x20\t]*$/,"\n");if(n[1])h=l.find(a),h&&h.close(d);else{if(h=new r(n[4],t),"function"==typeof h.beforeOpen)h.beforeOpen(d);h.open(d)}d.current=h}else if(!/^\s*\/\//.test(e))p.push(o,e,s);r=null},function(e){p.push(e)}),i(),m(d),d.targets}n.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var n=this.raw[t];if(e(n))return n}}};var M=178245,C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},K={html:function(e){return e.replace(/[&<>"']/g,r)},url:encodeURIComponent,raw:function(e){return e}},T='var r="";',S="r+=",D=";",E="return r;";if("undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8)T="var r=[],ri=0;",S="r[ri++]=",E='return r.join("");';u.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;if(!e||t.strip&&/^\s*$/.test(e))return"";else return d(e,this.engine,1)},getContent:function(){return this.value}},c.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();this.parent=t,t&&t.addChild(this),e.stack.push(this)},close:function(e){for(;e.stack.pop().constructor!==this.constructor;);},addTextNode:function(e){this.addChild(e)},getRendererBody:function(){for(var e=[],t=this.children,n=0;n<t.length;n++)e.push(t[n].getRendererBody());return e.join("")}};var J='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';a(p,c),a(f,c),a(V,c),a(U,c),a(g,c),a(y,c),a(b,c),a(_,c),a(k,c),a(v,c),a(x,v),a(L,c);var P={READING:1,READED:2,APPLIED:3,READY:4};f.prototype.close=f.prototype.autoClose=p.prototype.close=p.prototype.autoClose=function(e){c.prototype.close.call(this,e),this.state=this.master?P.READED:P.APPLIED,e.targetOrMaster=null},p.prototype.applyMaster=f.prototype.applyMaster=function(){if(this.state>=P.APPLIED)return 1;var e=this.engine.masters[this.master];if(e&&e.applyMaster()){this.children=[];for(var t=0,n=e.children.length;n>t;t++){var i=e.children[t];if(i instanceof U)this.children.push.apply(this.children,(this.contents[i.name]||i).children);else this.children.push(i)}return this.state=P.APPLIED,1}},p.prototype.isReady=function(){function e(i){for(var a=0,r=i.children.length;r>a;a++){var o=i.children[a];if(o instanceof g){var s=t.targets[o.name];n=n&&s&&s.isReady(t)}else if(o instanceof c)e(o)}}if(this.state>=P.READY)return 1;var t=this.engine,n=1;if(this.applyMaster())return e(this),n&&(this.state=P.READY),n;else return void 0},p.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[J,T,this.getRendererBody(),E].join("\n")),t=this.engine;return this.renderer=function(n){return e(n,t)},this.renderer}return null},p.prototype.getContent=function(){if(this.isReady()){for(var e=[],t=this.children,n=0;n<t.length;n++)e.push(t[n].getContent());return e.join("")}return""},p.prototype.open=f.prototype.open=function(e){m(e),c.prototype.open.call(this,e),this.state=P.READING,w(this,e)},g.prototype.open=y.prototype.open=_.prototype.open=function(e){var t=e.stack.top();this.parent=t,t.addChild(this)},_.prototype.beforeOpen=g.prototype.beforeOpen=y.prototype.beforeOpen=k.prototype.beforeOpen=b.prototype.beforeOpen=v.prototype.beforeOpen=u.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new p(i(),e.engine);t.open(e)}},_.prototype.close=g.prototype.close=L.prototype.close=y.prototype.close=function(){},g.prototype.getContent=function(){var e=this.engine.targets[this.name];return e.getContent()},g.prototype.getRendererBody=function(){var e=this.engine.targets[this.name];return e.getRendererBody()},_.prototype.getRendererBody=function(){return s("{0}engine.render({2},{{3}}){1}",S,D,o(this.name),d(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,n){return(t||"")+o(n)+":"}))},y.prototype.getRendererBody=function(){if(this.expr)return s("v[{0}]={1};",o(this.name),d(this.expr,this.engine));else return""},v.prototype.getRendererBody=function(){var e=s("if({0}){{1}}",d(this.value,this.engine),c.prototype.getRendererBody.call(this)),t=this["else"];if(t)return[e,s("else{{0}}",t.getRendererBody())].join("");else return e},k.prototype.getRendererBody=function(){return s('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',i(),d(this.list,this.engine),o(this.index||i()),o(this.item),i(),i(),c.prototype.getRendererBody.call(this))},b.prototype.getRendererBody=function(){var e=this.args;return s("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",T,E,S,D,c.prototype.getRendererBody.call(this),o(this.name),e?","+d(e,this.engine):"")},V.prototype.open=function(e){m(e,V),c.prototype.open.call(this,e),e.targetOrMaster.contents[this.name]=this},U.prototype.open=function(e){m(e,U),c.prototype.open.call(this,e)},V.prototype.autoClose=v.prototype.autoClose=c.prototype.close,U.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0,this.close(e)},v.prototype.addChild=function(e){var t=this["else"];(t?t.children:this.children).push(e)},x.prototype.open=function(e){var t=new L;t.open(e);var n=m(e,v);n.addChild(this),e.stack.push(this)},L.prototype.open=function(e){var t=m(e,v);t["else"]=this,e.stack.push(t)};var A={};W("target",p),W("master",f),W("content",V),W("contentplaceholder",U),W("import",g),W("use",_),W("var",y),W("for",k),W("if",v),W("elif",x),W("else",L),W("filter",b),I.prototype.config=function(e){t(this.options,e)},I.prototype.compile=I.prototype.parse=function(e){if(e){var t=X(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},I.prototype.getRenderer=function(e){var t=this.targets[e];if(t)return t.getRenderer();else return void 0},I.prototype.get=function(e){var t=this.targets[e];if(t)return t.getContent();else return""},I.prototype.render=function(e,t){var n=this.getRenderer(e);if(n)return n(t);else return""},I.prototype.addFilter=function(e,t){if("function"==typeof t)this.filters[e]=t};var F=new I;if(F.Engine=I,"object"==typeof exports&&"object"==typeof module)exports=module.exports=F;else if("function"==typeof define&&define.amd)define([],F);else e.etpl=F}(this);