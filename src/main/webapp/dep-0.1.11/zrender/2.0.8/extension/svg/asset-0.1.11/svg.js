define(["require","zrender/tool/http","zrender/shape/Circle","zrender/shape/Ellipse","zrender/shape/Rectangle","zrender/shape/Line","zrender/shape/Path","zrender/shape/Polygon","zrender/shape/Text","zrender/shape/Image","zrender/shape/Polyline","zrender/tool/matrix","zrender/tool/vector","zrender/tool/log","zrender/tool/guid","zrender/Group","zrender/tool/util"],function(require){"use strict";function e(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function t(e,t,n,a){if("object"==typeof e){var r=e;e=r.url,t=r.onsuccess,n=r.onerror,a=r}else if("object"==typeof n)a=n;V.get(e,function(e){t(i(e,a))},n)}function n(e){try{var t;if(window.DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length)W("Invalid XML: "+e);else return t}catch(i){return null}}function i(e,t){if(t=t||{},"undefined"==typeof t.hoverable)t.hoverable=!0;var i,r=t.namespace||I(),l=!1,h={},d=function(e,t,n){var i=e.nodeName.toLowerCase();if("defs"===i)l=!0;var u,c;if(l){var p=D[i];if(p){var m=p(e),f=e.getAttribute("id");if(f)h[f]=m}}else{var p=E[i];if(p){if(c=p(e,n,h),!c)return void W("Unsupported svg node "+i);u=o(e);for(var V in n)if(!u[V])u[V]=n[V];var g=a(e);if(g)c.transform=g,c.decomposeTransform();var f=e.getAttribute("id");if(f)c.id=r+"/"+f;if("group"!==c.type)s(c,u,h);t.addChild(c)}}if(l||"g"===i)for(var U=e.firstChild;U;){if(1===U.nodeType)d(U,c,u);U=U.nextSibling}if("defs"===i)l=!1};if("string"==typeof e){var u=n(e);if(!u)return;for(var i=u.firstChild;i&&("svg"!==i.nodeName.toLowerCase()||1!==i.nodeType);)i=i.nextSibling}else var i=e;if(i){for(var c=new X,p=i.firstChild;p;)d(p,c,{}),p=p.nextSibling;return c.traverse(function(e){if("group"!==e.type)e.hoverable=t.hoverable,e.clickable=t.clickable,e.draggable=t.draggable}),c}}function a(t){var n=t.getAttribute("transform");if(n){var i=w.create(),a=[];n.replace(M,function(e,t,n){a.push(t,n)});for(var r=a.length-1;r>0;r-=2){var o=a[r];o=e(o).replace(/,/g," ").split(/\s+/);var s=a[r-1];switch(s){case"translate":w.translate(i,i,[+o[0],+(o[1]||o[0])]);break;case"scale":w.scale(i,i,[+o[0],+(o[1]||o[0])]);break;case"rotate":w.rotate(i,i,+o[0]);break;case"skew":break;case"matrix":i[0]=+o[0],i[1]=+o[1],i[2]=+o[2],i[3]=+o[3],i[4]=+o[4],i[5]=+o[5]}}return i}}function r(e){var t=e.getAttribute("style");if(t){var n={};return t=t.replace(/\s*([;:])\s*/g,"$1"),t.replace(S,function(e,t,i){n[t]=i}),n}return{}}function o(e){for(var t={},n=0;n<K.length;n++){var i=K[n],a=e.getAttribute(i);if(a)t[i]=a}var o=r(e);for(var s in o)t[s]=o[s];return t}function s(e,t,n){var i="fill",a=l(t.fill,n),r=l(t.stroke,n);if(a)e.style.color=a,i="fill";if(r){if(e.style.strokeColor=r,a)i="both";else i="stroke";e.style.lineWidth=+(t["stroke-width"]||1)}t.opacity&&(e.style.opacity=+t.opacity),t["stroke-linecap"]&&(e.style.lineCap=+t["stroke-linecap"]),t["stroke-linejoin"]&&(e.style.lineJoin=+t["stroke-linejoin"]),t["stroke-miterlimit"]&&(e.style.miterLimit=+t["stroke-miterlimit"]),e.style.brushType=i}function l(e,t){if("none"!==e){var n=T.exec(e);if(n){var i=n[1].trim(),a=t[i];return a}return e}}function h(t){for(var n=e(t).replace(/,/g," ").split(/\s+/),i=[],a=0;a<n.length;){var r=+n[a++],o=+n[a++];i.push([r,o])}return i}function d(e,t){for(var n=e.firstChild;n;){if(1===n.nodeType){var i=n.getAttribute("offset");if(i.indexOf("%")>0)i=parseInt(i)/100;else if(i)i=parseFloat(i);else i=0;var a=n.getAttribute("stop-color")||"#000000";t.addColorStop(i,a)}n=n.nextSibling}}function u(e){for(var t=e.firstChild;t&&"tspan"!==t.nodeName.toLowerCase();)t=t.nextSibling;return!!t}function c(e,t){return p(e,0,0,t)}function p(e,t,n,i,a){var r=e.getAttribute("x"),l=e.getAttribute("y"),h=+e.getAttribute("dx")||0,d=+e.getAttribute("dy")||0;if(!r)r=t+h;else r=+(r||0);if(!l)l=n+d;else l=+(l||0);var c=o(e);for(var V in i)if(!c[V])c[V]=i[V];if(u(e)){var g=new X;g.rect={};var U=e.firstChild;for(g.rect.width=h,g.rect.x=r,g.rect.y=l;U;){if(3===U.nodeType){var y=m(U.textContent||U.nodeValue);if(y){var b=new k({style:{x:r,y:l,text:y,textFont:f(c)}});s(b,c,a);var _=b.getRect(b.style).width;r+=_,g.rect.width+=_,g.addChild(b)}}else if(1===U.nodeType&&"tspan"==U.nodeName.toLowerCase()){var v=p(U,r,l,c);l=v.rect.y,r+=v.rect.width,g.rect.width+=v.rect.width,g.addChild(v)}U=U.nextSibling}return g}else{for(var x="",U=e.firstChild;U;){if(3===U.nodeType)x+=U.textContent||U.nodeValue;U=U.nextSibling}var b=new k({style:{x:r,y:l,text:m(x),textFont:f(c)}});return s(b,c,a),b.rect={width:h+b.getRect(b.style).width,x:r,y:l},r+=b.getRect(b.style).width,b}}function m(t){return e(t.replace(/\n/g," ").replace(/\s+/g," "))}function f(e){var t=[];if(e["font-style"])t.push(e["font-style"]);if(e["font-weight"])t.push(e["font-weight"]);if(e["font-size"])t.push(+e["font-size"]+"px");if(e["font-family"])t.push(e["font-family"]);return t.join(" ")}var V=require("zrender/tool/http"),g=require("zrender/shape/Circle"),U=require("zrender/shape/Ellipse"),y=require("zrender/shape/Rectangle"),b=require("zrender/shape/Line"),_=require("zrender/shape/Path"),v=require("zrender/shape/Polygon"),k=require("zrender/shape/Text"),x=require("zrender/shape/Image"),L=require("zrender/shape/Polyline"),w=require("zrender/tool/matrix"),W=(require("zrender/tool/vector"),require("zrender/tool/log")),I=require("zrender/tool/guid"),X=require("zrender/Group"),C=require("zrender/tool/util"),M=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.,]*)\)/g,K=["fill","stroke","stroke-width","opacity","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","font-style","font-weight","font-size","font-family"],S=/(\S*?):(.*?);/g,T=/url\(\s*#(.*?)\)/,D={lineargradient:function(e){var t=+(e.getAttribute("x1")||0),n=+(e.getAttribute("y1")||0),i=+(e.getAttribute("x2")||10),a=+(e.getAttribute("y2")||0),r=C.getContext().createLinearGradient(t,n,i,a);return d(e,r),r},radialgradient:function(){}},E={g:function(){var e=new X;return e},rect:function(e){var t=+(e.getAttribute("x")||0),n=+(e.getAttribute("y")||0),i=+(e.getAttribute("width")||0),a=+(e.getAttribute("height")||0);return new y({style:{x:t,y:n,width:i,height:a}})},circle:function(e){var t=+(e.getAttribute("cx")||0),n=+(e.getAttribute("cy")||0),i=+(e.getAttribute("r")||0);return new g({style:{x:t,y:n,r:i}})},line:function(e){var t=+(e.getAttribute("x1")||0),n=+(e.getAttribute("y1")||0),i=+(e.getAttribute("x2")||0),a=+(e.getAttribute("y2")||0);return new b({style:{xStart:t,yStart:n,xEnd:i,yEnd:a}})},ellipse:function(e){var t=+(e.getAttribute("cx")||0),n=+(e.getAttribute("cy")||0),i=+(e.getAttribute("rx")||0),a=+(e.getAttribute("ry")||0);return new U({style:{x:t,y:n,a:i,b:a}})},polygon:function(e){var t=e.getAttribute("points");if(t){var n=h(t);return new v({style:{pointList:n}})}},polyline:function(e){var t=e.getAttribute("points");if(t){var n=h(t);return new L({style:{pointList:n}})}},path:function(e){var t=e.getAttribute("d");if(t)return new _({style:{path:t}});else return void 0},text:function(e,t,n){return c(e,t,n)},image:function(e){var t=+(e.getAttribute("x")||0),n=+(e.getAttribute("y")||0),i=+(e.getAttribute("width")||0),a=+(e.getAttribute("height")||0),r=e.getAttribute("xlink:href");if(r)return new x({style:{image:r,x:t,y:n,width:i,height:a}});else return void 0}};return{parse:i,load:t}});