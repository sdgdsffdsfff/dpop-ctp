define("zrender/shape/Image",["require","./Base","../tool/util"],function(require){var e=require("./Base"),t=function(t){e.call(this,t)};return t.prototype={type:"image",brush:function(e,t,i){var n=this.style||{};if(t)n=this.getHighlightStyle(n,this.highlightStyle||{});var a=n.image,r=this;if(!this._imageCache)this._imageCache={};if("string"==typeof a){var o=a;if(this._imageCache[o])a=this._imageCache[o];else a=new Image,a.onload=function(){a.onload=null,r.modSelf(),i()},a.src=o,this._imageCache[o]=a}if(a){if("IMG"==a.nodeName.toUpperCase())if(window.ActiveXObject){if("complete"!=a.readyState)return}else if(!a.complete)return;var s=n.width||a.width,l=n.height||a.height,h=n.x,d=n.y;if(!a.width||!a.height)return;if(e.save(),this.doClip(e),this.setContext(e,n),this.setTransform(e),n.sWidth&&n.sHeight){var u=n.sx||0,c=n.sy||0;e.drawImage(a,u,c,n.sWidth,n.sHeight,h,d,s,l)}else if(n.sx&&n.sy){var u=n.sx,c=n.sy,p=s-u,m=l-c;e.drawImage(a,u,c,p,m,h,d,s,l)}else e.drawImage(a,h,d,s,l);if(!n.width)n.width=s;if(!n.height)n.height=l;if(!this.style.width)this.style.width=s;if(!this.style.height)this.style.height=l;this.drawText(e,n,this.style),e.restore()}},getRect:function(e){return{x:e.x,y:e.y,width:e.width,height:e.height}},clearCache:function(){this._imageCache={}}},require("../tool/util").inherits(t,e),t});