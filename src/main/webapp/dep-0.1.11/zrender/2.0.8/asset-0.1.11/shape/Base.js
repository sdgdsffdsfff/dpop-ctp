define("zrender/shape/Base",["require","../tool/matrix","../tool/guid","../tool/util","../tool/log","../mixin/Transformable","../mixin/Eventful","../tool/area","../tool/color"],function(require){function e(e,i,n,a,r,o,s){if(r)e.font=r;e.textAlign=o,e.textBaseline=s;var l=t(i,n,a,r,o,s);i=(i+"").split("\n");var h=require("../tool/area").getTextHeight("国",r);switch(s){case"top":a=l.y;break;case"bottom":a=l.y+h;break;default:a=l.y+h/2}for(var d=0,u=i.length;u>d;d++)e.fillText(i[d],n,a),a+=h}function t(e,t,i,n,a,r){var o=require("../tool/area"),s=o.getTextWidth(e,n),l=o.getTextHeight("国",n);switch(e=(e+"").split("\n"),a){case"end":case"right":t-=s;break;case"center":t-=s/2}switch(r){case"top":break;case"bottom":i-=l*e.length;break;default:i-=l*e.length/2}return{x:t,y:i,width:s,height:l*e.length}}var i=window.G_vmlCanvasManager,n=require("../tool/matrix"),a=require("../tool/guid"),r=require("../tool/util"),o=require("../tool/log"),s=require("../mixin/Transformable"),l=require("../mixin/Eventful"),h=function(e){e=e||{},this.id=e.id||a();for(var t in e)this[t]=e[t];this.style=this.style||{},this.highlightStyle=this.highlightStyle||null,this.parent=null,this.__dirty=!0,this.__clipShapes=[],s.call(this),l.call(this)};h.prototype.invisible=!1,h.prototype.ignore=!1,h.prototype.zlevel=0,h.prototype.draggable=!1,h.prototype.clickable=!1,h.prototype.hoverable=!0,h.prototype.z=0,h.prototype.brush=function(e,t){var i=this.beforeBrush(e,t);switch(e.beginPath(),this.buildPath(e,i),i.brushType){case"both":e.fill();case"stroke":i.lineWidth>0&&e.stroke();break;default:e.fill()}this.drawText(e,i,this.style),this.afterBrush(e)},h.prototype.beforeBrush=function(e,t){var i=this.style;if(this.brushTypeOnly)i.brushType=this.brushTypeOnly;if(t)i=this.getHighlightStyle(i,this.highlightStyle||{},this.brushTypeOnly);if("stroke"==this.brushTypeOnly)i.strokeColor=i.strokeColor||i.color;return e.save(),this.doClip(e),this.setContext(e,i),this.setTransform(e),i},h.prototype.afterBrush=function(e){e.restore()};var d=[["color","fillStyle"],["strokeColor","strokeStyle"],["opacity","globalAlpha"],["lineCap","lineCap"],["lineJoin","lineJoin"],["miterLimit","miterLimit"],["lineWidth","lineWidth"],["shadowBlur","shadowBlur"],["shadowColor","shadowColor"],["shadowOffsetX","shadowOffsetX"],["shadowOffsetY","shadowOffsetY"]];h.prototype.setContext=function(e,t){for(var i=0,n=d.length;n>i;i++){var a=d[i][0],r=t[a],o=d[i][1];if("undefined"!=typeof r)e[o]=r}};var u=n.create();return h.prototype.doClip=function(e){if(this.__clipShapes&&!i)for(var t=0;t<this.__clipShapes.length;t++){var a=this.__clipShapes[t];if(a.needTransform){var r=a.transform;n.invert(u,r),e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}if(e.beginPath(),a.buildPath(e,a.style),e.clip(),a.needTransform){var r=u;e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}}},h.prototype.getHighlightStyle=function(e,t,i){var n={};for(var a in e)n[a]=e[a];var r=require("../tool/color"),o=r.getHighlightColor();if("stroke"!=e.brushType)n.strokeColor=o,n.lineWidth=(e.lineWidth||1)+this.getHighlightZoom(),n.brushType="both";else if("stroke"!=i)n.strokeColor=o,n.lineWidth=(e.lineWidth||1)+this.getHighlightZoom();else n.strokeColor=t.strokeColor||r.mix(e.strokeColor,r.toRGB(o));for(var a in t)if("undefined"!=typeof t[a])n[a]=t[a];return n},h.prototype.getHighlightZoom=function(){return"text"!=this.type?6:2},h.prototype.drift=function(e,t){this.position[0]+=e,this.position[1]+=t},h.prototype.buildPath=function(){o("buildPath not implemented in "+this.type)},h.prototype.getRect=function(){o("getRect not implemented in "+this.type)},h.prototype.isCover=function(e,t){var i=this.transformCoordToLocal(e,t);if(e=i[0],t=i[1],this.isCoverRect(e,t))return require("../tool/area").isInside(this,this.style,e,t);else return!1},h.prototype.isCoverRect=function(e,t){var i=this.style.__rect;if(!i)i=this.style.__rect=this.getRect(this.style);return e>=i.x&&e<=i.x+i.width&&t>=i.y&&t<=i.y+i.height},h.prototype.drawText=function(t,i,n){if("undefined"!=typeof i.text&&i.text!==!1){var a=i.textColor||i.color||i.strokeColor;t.fillStyle=a;var r,o,s,l,h=10,d=i.textPosition||this.textPosition||"top";switch(d){case"inside":case"top":case"bottom":case"left":case"right":if(this.getRect){var u=(n||i).__rect||this.getRect(n||i);switch(d){case"inside":if(s=u.x+u.width/2,l=u.y+u.height/2,r="center",o="middle","stroke"!=i.brushType&&a==i.color)t.fillStyle="#fff";break;case"left":s=u.x-h,l=u.y+u.height/2,r="end",o="middle";break;case"right":s=u.x+u.width+h,l=u.y+u.height/2,r="start",o="middle";break;case"top":s=u.x+u.width/2,l=u.y-h,r="center",o="bottom";break;case"bottom":s=u.x+u.width/2,l=u.y+u.height+h,r="center",o="top"}}break;case"start":case"end":var c=i.pointList||[[i.xStart||0,i.yStart||0],[i.xEnd||0,i.yEnd||0]],p=c.length;if(2>p)return;var m,f,g,y;switch(d){case"start":m=c[1][0],f=c[0][0],g=c[1][1],y=c[0][1];break;case"end":m=c[p-2][0],f=c[p-1][0],g=c[p-2][1],y=c[p-1][1]}s=f,l=y;var V=Math.atan((g-y)/(f-m))/Math.PI*180;if(0>f-m)V+=180;else if(0>g-y)V+=360;if(h=5,V>=30&&150>=V)r="center",o="bottom",l-=h;else if(V>150&&210>V)r="right",o="middle",s-=h;else if(V>=210&&330>=V)r="center",o="top",l+=h;else r="left",o="middle",s+=h;break;case"specific":s=i.textX||0,l=i.textY||0,r="start",o="middle"}if(null!=s&&null!=l)e(t,i.text,s,l,i.textFont,i.textAlign||r,i.textBaseline||o)}},h.prototype.modSelf=function(){if(this.__dirty=!0,this.style)this.style.__rect=null;if(this.highlightStyle)this.highlightStyle.__rect=null},h.prototype.isSilent=function(){return!(this.hoverable||this.draggable||this.clickable||this.onmousemove||this.onmouseover||this.onmouseout||this.onmousedown||this.onmouseup||this.onclick||this.ondragenter||this.ondragover||this.ondragleave||this.ondrop)},r.merge(h.prototype,s.prototype,!0),r.merge(h.prototype,l.prototype,!0),h});