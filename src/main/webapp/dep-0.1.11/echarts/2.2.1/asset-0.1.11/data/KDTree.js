define("echarts/data/KDTree",["require","./quickSelect"],function(require){function t(t,e){this.left=null,this.right=null,this.axis=t,this.data=e}var e=require("./quickSelect"),i=function(t,e){if(t.length){if(!e)e=t[0].array.length;this.dimension=e,this.root=this._buildTree(t,0,t.length-1,0),this._stack=[],this._nearstNList=[]}};return i.prototype._buildTree=function(i,s,a,o){if(s>a)return null;var r=Math.floor((s+a)/2);r=e(i,s,a,r,function(t,e){return t.array[o]-e.array[o]});var n=i[r],h=new t(o,n);if(o=(o+1)%this.dimension,a>s)h.left=this._buildTree(i,s,r-1,o),h.right=this._buildTree(i,r+1,a,o);return h},i.prototype.nearest=function(t,e){var i=this.root,s=this._stack,a=0,o=1/0,r=null;if(i.data!==t)o=e(i.data,t),r=i;if(t.array[i.axis]<i.data.array[i.axis])i.right&&(s[a++]=i.right),i.left&&(s[a++]=i.left);else i.left&&(s[a++]=i.left),i.right&&(s[a++]=i.right);for(;a--;){i=s[a];var n=t.array[i.axis]-i.data.array[i.axis],h=0>n,l=!1;if(n*=n,o>n){if(n=e(i.data,t),o>n&&i.data!==t)o=n,r=i;l=!0}if(h){if(l)i.right&&(s[a++]=i.right);i.left&&(s[a++]=i.left)}else{if(l)i.left&&(s[a++]=i.left);i.right&&(s[a++]=i.right)}}return r.data},i.prototype._addNearest=function(t,e,i){for(var s=this._nearstNList,a=t-1;a>0&&!(e>=s[a-1].dist);a--)s[a].dist=s[a-1].dist,s[a].node=s[a-1].node;s[a].dist=e,s[a].node=i},i.prototype.nearestN=function(t,e,i,s){if(0>=e)return s.length=0,s;for(var a=this.root,o=this._stack,r=0,n=this._nearstNList,h=0;e>h;h++){if(!n[h])n[h]={};n[h].dist=0,n[h].node=null}var l=i(a.data,t),d=0;if(a.data!==t)d++,this._addNearest(d,l,a);if(t.array[a.axis]<a.data.array[a.axis])a.right&&(o[r++]=a.right),a.left&&(o[r++]=a.left);else a.left&&(o[r++]=a.left),a.right&&(o[r++]=a.right);for(;r--;){a=o[r];var l=t.array[a.axis]-a.data.array[a.axis],p=0>l,c=!1;if(l*=l,e>d||l<n[d-1].dist){if(l=i(a.data,t),(e>d||l<n[d-1].dist)&&a.data!==t){if(e>d)d++;this._addNearest(d,l,a)}c=!0}if(p){if(c)a.right&&(o[r++]=a.right);a.left&&(o[r++]=a.left)}else{if(c)a.left&&(o[r++]=a.left);a.right&&(o[r++]=a.right)}}for(var h=0;d>h;h++)s[h]=n[h].node.data;return s.length=d,s},i});