define("echarts/component/dataRange",["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../util/shape/HandlePolygon","../config","zrender/tool/util","zrender/tool/event","zrender/tool/area","zrender/tool/color","../component"],function(require){function e(e,i,a,s,o){if("undefined"==typeof this.query(s,"dataRange.min")||"undefined"==typeof this.query(s,"dataRange.max"))return void console.error("option.dataRange.min or option.dataRange.max has not been defined.");t.call(this,e,i,a,s,o);var n=this;n._ondrift=function(e,t){return n.__ondrift(this,e,t)},n._ondragend=function(){return n.__ondragend()},n._dataRangeSelected=function(e){return n.__dataRangeSelected(e)},n._dispatchHoverLink=function(e){return n.__dispatchHoverLink(e)},n._onhoverlink=function(e){return n.__onhoverlink(e)},this._selectedMap={},this._range={},this.refresh(s),i.bind(r.EVENT.HOVER,this._onhoverlink)}var t=require("./base"),i=require("zrender/shape/Text"),a=require("zrender/shape/Rectangle"),s=require("../util/shape/HandlePolygon"),r=require("../config");r.dataRange={zlevel:0,z:4,show:!0,orient:"vertical",x:"left",y:"bottom",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,itemWidth:20,itemHeight:14,precision:0,splitNumber:5,calculable:!1,selectedMode:!0,hoverLink:!0,realtime:!0,color:["#006edd","#e0ffff"],textStyle:{color:"#333"}};var o=require("zrender/tool/util"),n=require("zrender/tool/event"),l=require("zrender/tool/area"),h=require("zrender/tool/color");return e.prototype={type:r.COMPONENT_TYPE_DATARANGE,_textGap:10,_buildShape:function(){if(this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)this._buildGradient();else this._buildItem();if(this.dataRangeOption.show)for(var e=0,t=this.shapeList.length;t>e;e++)this.zr.addShape(this.shapeList[e]);this._syncShapeFromRange()},_buildItem:function(){var e,t,s,r,o=this._valueTextList,n=o.length,h=this.getFont(this.dataRangeOption.textStyle),d=this._itemGroupLocation.x,p=this._itemGroupLocation.y,c=this.dataRangeOption.itemWidth,g=this.dataRangeOption.itemHeight,u=this.dataRangeOption.itemGap,f=l.getTextHeight("国",h);if("vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x)d=this._itemGroupLocation.x+this._itemGroupLocation.width-c;var y=!0;if(this.dataRangeOption.text)if(y=!1,this.dataRangeOption.text[0]){if(s=this._getTextShape(d,p,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient)d+=l.getTextWidth(this.dataRangeOption.text[0],h)+this._textGap;else p+=f+this._textGap,s.style.y+=f/2+this._textGap,s.style.textBaseline="bottom";this.shapeList.push(new i(s))}for(var m=0;n>m;m++){if(e=o[m],r=this.getColorByIndex(m),t=this._getItemShape(d,p,c,g,this._selectedMap[m]?r:"#ccc"),t._idx=m,t.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode)t.clickable=!0,t.onclick=this._dataRangeSelected;if(this.shapeList.push(new a(t)),y){if(s={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:d+c+5,y:p,color:this._selectedMap[m]?this.dataRangeOption.textStyle.color:"#ccc",text:o[m],textFont:h,textBaseline:"top"},highlightStyle:{brushType:"fill"}},"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x)s.style.x-=c+10,s.style.textAlign="right";if(s._idx=m,s.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode)s.clickable=!0,s.onclick=this._dataRangeSelected;this.shapeList.push(new i(s))}if("horizontal"==this.dataRangeOption.orient)d+=c+(y?5:0)+(y?l.getTextWidth(e,h):0)+u;else p+=g+u}if(!y&&this.dataRangeOption.text[1]){if("horizontal"==this.dataRangeOption.orient)d=d-u+this._textGap;else p=p-u+this._textGap;if(s=this._getTextShape(d,p,this.dataRangeOption.text[1]),"horizontal"!=this.dataRangeOption.orient)s.style.y-=5,s.style.textBaseline="top";this.shapeList.push(new i(s))}},_buildGradient:function(){var e,t,s=this.getFont(this.dataRangeOption.textStyle),r=this._itemGroupLocation.x,o=this._itemGroupLocation.y,n=this.dataRangeOption.itemWidth,h=this.dataRangeOption.itemHeight,d=l.getTextHeight("国",s),p=10,c=!0;if(this.dataRangeOption.text)if(c=!1,this.dataRangeOption.text[0]){if(t=this._getTextShape(r,o,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient)r+=l.getTextWidth(this.dataRangeOption.text[0],s)+this._textGap;else o+=d+this._textGap,t.style.y+=d/2+this._textGap,t.style.textBaseline="bottom";this.shapeList.push(new i(t))}for(var g=require("zrender/tool/color"),u=1/(this.dataRangeOption.color.length-1),f=[],y=0,m=this.dataRangeOption.color.length;m>y;y++)f.push([y*u,this.dataRangeOption.color[y]]);if("horizontal"==this.dataRangeOption.orient)e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:r,y:o,width:n*p,height:h,color:g.getLinearGradient(r,o,r+n*p,o,f)},hoverable:!1},r+=n*p+this._textGap;else e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:r,y:o,width:n,height:h*p,color:g.getLinearGradient(r,o,r,o+h*p,f)},hoverable:!1},o+=h*p+this._textGap;if(this.shapeList.push(new a(e)),this._calculableLocation=e.style,this.dataRangeOption.calculable)this._buildFiller(),this._bulidMask(),this._bulidHandle();if(this._buildIndicator(),!c&&this.dataRangeOption.text[1])t=this._getTextShape(r,o,this.dataRangeOption.text[1]),this.shapeList.push(new i(t))},_buildIndicator:function(){var e,t,i=this._calculableLocation.x,a=this._calculableLocation.y,r=this._calculableLocation.width,o=this._calculableLocation.height,n=5;if("horizontal"==this.dataRangeOption.orient)if("bottom"!=this.dataRangeOption.y)e=[[i,a+o],[i-n,a+o+n],[i+n,a+o+n]],t="bottom";else e=[[i,a],[i-n,a-n],[i+n,a-n]],t="top";else if("right"!=this.dataRangeOption.x)e=[[i+r,a],[i+r+n,a-n],[i+r+n,a+n]],t="right";else e=[[i,a],[i-n,a-n],[i-n,a+n]],t="left";this._indicatorShape={style:{pointList:e,color:"#fff",__rect:{x:Math.min(e[0][0],e[1][0]),y:Math.min(e[0][1],e[1][1]),width:n*("horizontal"==this.dataRangeOption.orient?2:1),height:n*("horizontal"==this.dataRangeOption.orient?1:2)}},highlightStyle:{brushType:"fill",textPosition:t,textColor:this.dataRangeOption.textStyle.color},hoverable:!1},this._indicatorShape=new s(this._indicatorShape)},_buildFiller:function(){this._fillerShape={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:this._calculableLocation.x,y:this._calculableLocation.y,width:this._calculableLocation.width,height:this._calculableLocation.height,color:"rgba(255,255,255,0)"},highlightStyle:{strokeColor:"rgba(255,255,255,0.5)",lineWidth:1},draggable:!0,ondrift:this._ondrift,ondragend:this._ondragend,onmousemove:this._dispatchHoverLink,_type:"filler"},this._fillerShape=new a(this._fillerShape),this.shapeList.push(this._fillerShape)},_bulidHandle:function(){var e,t,i,a,r,o,n,h,d=this._calculableLocation.x,p=this._calculableLocation.y,c=this._calculableLocation.width,g=this._calculableLocation.height,u=this.getFont(this.dataRangeOption.textStyle),f=l.getTextHeight("国",u),y=Math.max(l.getTextWidth(this._textFormat(this.dataRangeOption.max),u),l.getTextWidth(this._textFormat(this.dataRangeOption.min),u))+2;if("horizontal"==this.dataRangeOption.orient)if("bottom"!=this.dataRangeOption.y)e=[[d,p],[d,p+g+f],[d-f,p+g+f],[d-1,p+g],[d-1,p]],t=d-y/2-f,i=p+g+f/2+2,a={x:d-y-f,y:p+g,width:y+f,height:f},r=[[d+c,p],[d+c,p+g+f],[d+c+f,p+g+f],[d+c+1,p+g],[d+c+1,p]],o=d+c+y/2+f,n=i,h={x:d+c,y:p+g,width:y+f,height:f};else e=[[d,p+g],[d,p-f],[d-f,p-f],[d-1,p],[d-1,p+g]],t=d-y/2-f,i=p-f/2-2,a={x:d-y-f,y:p-f,width:y+f,height:f},r=[[d+c,p+g],[d+c,p-f],[d+c+f,p-f],[d+c+1,p],[d+c+1,p+g]],o=d+c+y/2+f,n=i,h={x:d+c,y:p-f,width:y+f,height:f};else if(y+=f,"right"!=this.dataRangeOption.x)e=[[d,p],[d+c+f,p],[d+c+f,p-f],[d+c,p-1],[d,p-1]],t=d+c+y/2+f/2,i=p-f/2,a={x:d+c,y:p-f,width:y+f,height:f},r=[[d,p+g],[d+c+f,p+g],[d+c+f,p+f+g],[d+c,p+1+g],[d,p+g+1]],o=t,n=p+g+f/2,h={x:d+c,y:p+g,width:y+f,height:f};else e=[[d+c,p],[d-f,p],[d-f,p-f],[d,p-1],[d+c,p-1]],t=d-y/2-f/2,i=p-f/2,a={x:d-y-f,y:p-f,width:y+f,height:f},r=[[d+c,p+g],[d-f,p+g],[d-f,p+f+g],[d,p+1+g],[d+c,p+g+1]],o=t,n=p+g+f/2,h={x:d-y-f,y:p+g,width:y+f,height:f};this._startShape={style:{pointList:e,text:this._textFormat(this.dataRangeOption.max),textX:t,textY:i,textFont:u,color:this.getColor(this.dataRangeOption.max),rect:a,x:e[0][0],y:e[0][1],_x:e[0][0],_y:e[0][1]}},this._startShape.highlightStyle={strokeColor:this._startShape.style.color,lineWidth:1},this._endShape={style:{pointList:r,text:this._textFormat(this.dataRangeOption.min),textX:o,textY:n,textFont:u,color:this.getColor(this.dataRangeOption.min),rect:h,x:r[0][0],y:r[0][1],_x:r[0][0],_y:r[0][1]}},this._endShape.highlightStyle={strokeColor:this._endShape.style.color,lineWidth:1},this._startShape.zlevel=this._endShape.zlevel=this.getZlevelBase(),this._startShape.z=this._endShape.z=this.getZBase()+1,this._startShape.draggable=this._endShape.draggable=!0,this._startShape.ondrift=this._endShape.ondrift=this._ondrift,this._startShape.ondragend=this._endShape.ondragend=this._ondragend,this._startShape.style.textColor=this._endShape.style.textColor=this.dataRangeOption.textStyle.color,this._startShape.style.textAlign=this._endShape.style.textAlign="center",this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape.style.textBaseline=this._endShape.style.textBaseline="middle",this._startShape.style.width=this._endShape.style.width=0,this._startShape.style.height=this._endShape.style.height=0,this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape=new s(this._startShape),this._endShape=new s(this._endShape),this.shapeList.push(this._startShape),this.shapeList.push(this._endShape)},_bulidMask:function(){var e=this._calculableLocation.x,t=this._calculableLocation.y,i=this._calculableLocation.width,s=this._calculableLocation.height;this._startMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:e,y:t,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?s:0,color:"#ccc"},hoverable:!1},this._endMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:"horizontal"==this.dataRangeOption.orient?e+i:e,y:"horizontal"==this.dataRangeOption.orient?t:t+s,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?s:0,color:"#ccc"},hoverable:!1},this._startMask=new a(this._startMask),this._endMask=new a(this._endMask),this.shapeList.push(this._startMask),this.shapeList.push(this._endMask)},_buildBackground:function(){var e=this.reformCssArray(this.dataRangeOption.padding);this.shapeList.push(new a({zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this._itemGroupLocation.x-e[3],y:this._itemGroupLocation.y-e[0],width:this._itemGroupLocation.width+e[3]+e[1],height:this._itemGroupLocation.height+e[0]+e[2],brushType:0===this.dataRangeOption.borderWidth?"fill":"both",color:this.dataRangeOption.backgroundColor,strokeColor:this.dataRangeOption.borderColor,lineWidth:this.dataRangeOption.borderWidth}}))},_getItemGroupLocation:function(){var e=this._valueTextList,t=e.length,i=this.dataRangeOption.itemGap,a=this.dataRangeOption.itemWidth,s=this.dataRangeOption.itemHeight,r=0,o=0,n=this.getFont(this.dataRangeOption.textStyle),h=l.getTextHeight("国",n),d=10;if("horizontal"==this.dataRangeOption.orient){if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)r=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?a*d+i:t*(a+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?l.getTextWidth(this.dataRangeOption.text[0],n)+this._textGap:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?l.getTextWidth(this.dataRangeOption.text[1],n)+this._textGap:0);else{a+=5;for(var p=0;t>p;p++)r+=a+l.getTextWidth(e[p],n)+i}r-=i,o=Math.max(h,s)}else{var c;if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)o=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?s*d+i:t*(s+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?this._textGap+h:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?this._textGap+h:0),c=Math.max(l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[0]||"",n),l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[1]||"",n)),r=Math.max(a,c);else{o=(s+i)*t,a+=5,c=0;for(var p=0;t>p;p++)c=Math.max(c,l.getTextWidth(e[p],n));r=a+c}o-=i}var g,u=this.reformCssArray(this.dataRangeOption.padding),f=this.zr.getWidth();switch(this.dataRangeOption.x){case"center":g=Math.floor((f-r)/2);break;case"left":g=u[3]+this.dataRangeOption.borderWidth;break;case"right":g=f-r-u[1]-this.dataRangeOption.borderWidth;break;default:g=this.parsePercent(this.dataRangeOption.x,f),g=isNaN(g)?0:g}var y,m=this.zr.getHeight();switch(this.dataRangeOption.y){case"top":y=u[0]+this.dataRangeOption.borderWidth;break;case"bottom":y=m-o-u[2]-this.dataRangeOption.borderWidth;break;case"center":y=Math.floor((m-o)/2);break;default:y=this.parsePercent(this.dataRangeOption.y,m),y=isNaN(y)?0:y}if(this.dataRangeOption.calculable){var _=Math.max(l.getTextWidth(this.dataRangeOption.max,n),l.getTextWidth(this.dataRangeOption.min,n))+h;if("horizontal"==this.dataRangeOption.orient){if(_>g)g=_;if(g+r+_>f)g-=_}else{if(h>y)y=h;if(y+o+h>m)y-=h}}return{x:g,y:y,width:r,height:o}},_getTextShape:function(e,t,i){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:"horizontal"==this.dataRangeOption.orient?e:this._itemGroupLocation.x+this._itemGroupLocation.width/2,y:"horizontal"==this.dataRangeOption.orient?this._itemGroupLocation.y+this._itemGroupLocation.height/2:t,color:this.dataRangeOption.textStyle.color,text:i,textFont:this.getFont(this.dataRangeOption.textStyle),textBaseline:"horizontal"==this.dataRangeOption.orient?"middle":"top",textAlign:"horizontal"==this.dataRangeOption.orient?"left":"center"},hoverable:!1}},_getItemShape:function(e,t,i,a,s){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:e,y:t+1,width:i,height:a-2,color:s},highlightStyle:{strokeColor:s,lineWidth:1}}},__ondrift:function(e,t,i){var a=this._calculableLocation.x,s=this._calculableLocation.y,r=this._calculableLocation.width,o=this._calculableLocation.height;if("horizontal"==this.dataRangeOption.orient)if(e.style.x+t<=a)e.style.x=a;else if(e.style.x+t+e.style.width>=a+r)e.style.x=a+r-e.style.width;else e.style.x+=t;else if(e.style.y+i<=s)e.style.y=s;else if(e.style.y+i+e.style.height>=s+o)e.style.y=s+o-e.style.height;else e.style.y+=i;if("filler"==e._type)this._syncHandleShape();else this._syncFillerShape(e);if(this.dataRangeOption.realtime)this._dispatchDataRange();return!0},__ondragend:function(){this.isDragend=!0},ondragend:function(e,t){if(this.isDragend&&e.target){if(t.dragOut=!0,t.dragIn=!0,!this.dataRangeOption.realtime)this._dispatchDataRange();t.needRefresh=!1,this.isDragend=!1}},_syncShapeFromRange:function(){var e=this.dataRangeOption.range||{};if(this._range.end="undefined"!=typeof this._range.end?this._range.end:"undefined"!=typeof e.start?e.start:0,this._range.start="undefined"!=typeof this._range.start?this._range.start:"undefined"!=typeof e.end?e.end:100,100!=this._range.start||0!==this._range.end){if("horizontal"==this.dataRangeOption.orient){var t=this._fillerShape.style.width;this._fillerShape.style.x+=t*(100-this._range.start)/100,this._fillerShape.style.width=t*(this._range.start-this._range.end)/100}else{var i=this._fillerShape.style.height;this._fillerShape.style.y+=i*(100-this._range.start)/100,this._fillerShape.style.height=i*(this._range.start-this._range.end)/100}this.zr.modShape(this._fillerShape.id),this._syncHandleShape()}},_syncHandleShape:function(){var e=this._calculableLocation.x,t=this._calculableLocation.y,i=this._calculableLocation.width,a=this._calculableLocation.height;if("horizontal"==this.dataRangeOption.orient)this._startShape.style.x=this._fillerShape.style.x,this._startMask.style.width=this._startShape.style.x-e,this._endShape.style.x=this._fillerShape.style.x+this._fillerShape.style.width,this._endMask.style.x=this._endShape.style.x,this._endMask.style.width=e+i-this._endShape.style.x,this._range.start=Math.ceil(100-(this._startShape.style.x-e)/i*100),this._range.end=Math.floor(100-(this._endShape.style.x-e)/i*100);else this._startShape.style.y=this._fillerShape.style.y,this._startMask.style.height=this._startShape.style.y-t,this._endShape.style.y=this._fillerShape.style.y+this._fillerShape.style.height,this._endMask.style.y=this._endShape.style.y,this._endMask.style.height=t+a-this._endShape.style.y,this._range.start=Math.ceil(100-(this._startShape.style.y-t)/a*100),this._range.end=Math.floor(100-(this._endShape.style.y-t)/a*100);this._syncShape()},_syncFillerShape:function(e){var t,i,a=this._calculableLocation.x,s=this._calculableLocation.y,r=this._calculableLocation.width,o=this._calculableLocation.height;if("horizontal"==this.dataRangeOption.orient){if(t=this._startShape.style.x,i=this._endShape.style.x,e.id==this._startShape.id&&t>=i)i=t,this._endShape.style.x=t;else if(e.id==this._endShape.id&&t>=i)t=i,this._startShape.style.x=t;this._fillerShape.style.x=t,this._fillerShape.style.width=i-t,this._startMask.style.width=t-a,this._endMask.style.x=i,this._endMask.style.width=a+r-i,this._range.start=Math.ceil(100-(t-a)/r*100),this._range.end=Math.floor(100-(i-a)/r*100)}else{if(t=this._startShape.style.y,i=this._endShape.style.y,e.id==this._startShape.id&&t>=i)i=t,this._endShape.style.y=t;else if(e.id==this._endShape.id&&t>=i)t=i,this._startShape.style.y=t;this._fillerShape.style.y=t,this._fillerShape.style.height=i-t,this._startMask.style.height=t-s,this._endMask.style.y=i,this._endMask.style.height=s+o-i,this._range.start=Math.ceil(100-(t-s)/o*100),this._range.end=Math.floor(100-(i-s)/o*100)}this._syncShape()},_syncShape:function(){this._startShape.position=[this._startShape.style.x-this._startShape.style._x,this._startShape.style.y-this._startShape.style._y],this._startShape.style.text=this._textFormat(this._gap*this._range.start+this.dataRangeOption.min),this._startShape.style.color=this._startShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.start+this.dataRangeOption.min),this._endShape.position=[this._endShape.style.x-this._endShape.style._x,this._endShape.style.y-this._endShape.style._y],this._endShape.style.text=this._textFormat(this._gap*this._range.end+this.dataRangeOption.min),this._endShape.style.color=this._endShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.end+this.dataRangeOption.min),this.zr.modShape(this._startShape.id),this.zr.modShape(this._endShape.id),this.zr.modShape(this._startMask.id),this.zr.modShape(this._endMask.id),this.zr.modShape(this._fillerShape.id),this.zr.refreshNextFrame()},_dispatchDataRange:function(){this.messageCenter.dispatch(r.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart)},__dataRangeSelected:function(e){if("single"===this.dataRangeOption.selectedMode)for(var t in this._selectedMap)this._selectedMap[t]=!1;var i=e.target._idx;this._selectedMap[i]=!this._selectedMap[i];var a=(this._colorList.length-i)*this._gap+this.dataRangeOption.min;this.messageCenter.dispatch(r.EVENT.DATA_RANGE_SELECTED,e.event,{selected:this._selectedMap,target:i,valueMax:a,valueMin:a-this._gap},this.myChart),this.messageCenter.dispatch(r.EVENT.REFRESH,null,null,this.myChart)},__dispatchHoverLink:function(e){var t,i;if(this.dataRangeOption.calculable){var a,s=this.dataRangeOption.max-this.dataRangeOption.min;if("horizontal"==this.dataRangeOption.orient)a=(1-(n.getX(e.event)-this._calculableLocation.x)/this._calculableLocation.width)*s;else a=(1-(n.getY(e.event)-this._calculableLocation.y)/this._calculableLocation.height)*s;t=a-.05*s,i=a+.05*s}else{var o=e.target._idx;i=(this._colorList.length-o)*this._gap+this.dataRangeOption.min,t=i-this._gap}this.messageCenter.dispatch(r.EVENT.DATA_RANGE_HOVERLINK,e.event,{valueMin:t,valueMax:i},this.myChart)},__onhoverlink:function(e){if(this.dataRangeOption.show&&this.dataRangeOption.hoverLink&&this._indicatorShape&&e&&null!=e.seriesIndex&&null!=e.dataIndex){var t=e.value;if(""===t||isNaN(t))return;if(t<this.dataRangeOption.min)t=this.dataRangeOption.min;else if(t>this.dataRangeOption.max)t=this.dataRangeOption.max;if("horizontal"==this.dataRangeOption.orient)this._indicatorShape.position=[(this.dataRangeOption.max-t)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.width,0];else this._indicatorShape.position=[0,(this.dataRangeOption.max-t)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.height];this._indicatorShape.style.text=this._textFormat(e.value),this._indicatorShape.style.color=this.getColor(t),this.zr.addHoverShape(this._indicatorShape)}},_textFormat:function(e,t){if(e=(+e).toFixed(this.dataRangeOption.precision),t=null!=t?(+t).toFixed(this.dataRangeOption.precision):"",this.dataRangeOption.formatter)if("string"==typeof this.dataRangeOption.formatter)return this.dataRangeOption.formatter.replace("{value}",e).replace("{value2}",t);else if("function"==typeof this.dataRangeOption.formatter)return this.dataRangeOption.formatter.call(this.myChart,e,t);if(""!==t)return e+" - "+t;else return e},refresh:function(e){if(e){if(this.option=e,this.option.dataRange=this.reformOption(this.option.dataRange),this.dataRangeOption=this.option.dataRange,!this.myChart.canvasSupported)this.dataRangeOption.realtime=!1;var t=this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?100:this.dataRangeOption.splitNumber;if(this._colorList=h.getGradientColors(this.dataRangeOption.color,Math.max((t-this.dataRangeOption.color.length)/(this.dataRangeOption.color.length-1),0)+1),this._colorList.length>t){for(var i=this._colorList.length,a=[this._colorList[0]],s=i/(t-1),r=1;t-1>r;r++)a.push(this._colorList[Math.floor(r*s)]);a.push(this._colorList[i-1]),this._colorList=a}var o=this.dataRangeOption.precision;for(this._gap=(this.dataRangeOption.max-this.dataRangeOption.min)/t;this._gap.toFixed(o)-0!=this._gap&&5>o;)o++;this.dataRangeOption.precision=o,this._gap=((this.dataRangeOption.max-this.dataRangeOption.min)/t).toFixed(o)-0,this._valueTextList=[];for(var r=0;t>r;r++)this._selectedMap[r]=!0,this._valueTextList.unshift(this._textFormat(r*this._gap+this.dataRangeOption.min,(r+1)*this._gap+this.dataRangeOption.min))}this.clear(),this._buildShape()},getColor:function(e){if(isNaN(e))return null;if(this.dataRangeOption.min==this.dataRangeOption.max)return this._colorList[0];if(e<this.dataRangeOption.min)e=this.dataRangeOption.min;else if(e>this.dataRangeOption.max)e=this.dataRangeOption.max;if(this.dataRangeOption.calculable)if(e-(this._gap*this._range.start+this.dataRangeOption.min)>5e-5||e-(this._gap*this._range.end+this.dataRangeOption.min)<-5e-5)return null;var t=this._colorList.length-Math.ceil((e-this.dataRangeOption.min)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._colorList.length);if(t==this._colorList.length)t--;if(this._selectedMap[t])return this._colorList[t];else return null},getColorByIndex:function(e){if(e>=this._colorList.length)e=this._colorList.length-1;else if(0>e)e=0;return this._colorList[e]},onbeforDispose:function(){this.messageCenter.unbind(r.EVENT.HOVER,this._onhoverlink)}},o.inherits(e,t),require("../component").define("dataRange",e),e});