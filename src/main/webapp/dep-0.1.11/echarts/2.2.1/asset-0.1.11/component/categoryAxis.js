define("echarts/component/categoryAxis",["require","./base","zrender/shape/Text","zrender/shape/Line","zrender/shape/Rectangle","../config","zrender/tool/util","zrender/tool/area","../component"],function(require){function e(e,i,s,a,r,o){if(a.data.length<1)return void console.error("option.data.length < 1.");t.call(this,e,i,s,a,r),this.grid=this.component.grid;for(var n in o)this[n]=o[n];this.refresh(a)}var t=require("./base"),i=require("zrender/shape/Text"),s=require("zrender/shape/Line"),a=require("zrender/shape/Rectangle"),r=require("../config");r.categoryAxis={zlevel:0,z:0,show:!0,position:"bottom",name:"",nameLocation:"end",nameTextStyle:{},boundaryGap:!0,axisLine:{show:!0,onZero:!0,lineStyle:{color:"#48b",width:2,type:"solid"}},axisTick:{show:!0,interval:"auto",inside:!1,length:5,lineStyle:{color:"#333",width:1}},axisLabel:{show:!0,interval:"auto",rotate:0,margin:8,textStyle:{color:"#333"}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}};var o=require("zrender/tool/util"),n=require("zrender/tool/area");return e.prototype={type:r.COMPONENT_TYPE_AXIS_CATEGORY,_getReformedLabel:function(e){var t=this.getDataFromOption(this.option.data[e]),i=this.option.data[e].formatter||this.option.axisLabel.formatter;if(i)if("function"==typeof i)t=i.call(this.myChart,t);else if("string"==typeof i)t=i.replace("{value}",t);return t},_getInterval:function(){var e=this.option.axisLabel.interval;if("auto"==e){var t=this.option.axisLabel.textStyle.fontSize,i=this.option.data,s=this.option.data.length;if(this.isHorizontal())if(s>3){var a,r,l=this.getGap(),h=!1,d=Math.floor(.5/l);for(d=1>d?1:d,e=Math.floor(15/l);!h&&s>e;){e+=d,h=!0,a=Math.floor(l*e);for(var p=Math.floor((s-1)/e)*e;p>=0;p-=e){if(0!==this.option.axisLabel.rotate)r=t;else if(i[p].textStyle)r=n.getTextWidth(this._getReformedLabel(p),this.getFont(o.merge(i[p].textStyle,this.option.axisLabel.textStyle)));else{var c=this._getReformedLabel(p)+"",u=(c.match(/\w/g)||"").length,g=c.length-u;r=u*t*2/3+g*t}if(r>a){h=!1;break}}}}else e=1;else if(s>3){var l=this.getGap();for(e=Math.floor(11/l);t>l*e-6&&s>e;)e++}else e=1}else e="function"==typeof e?1:e-0+1;return e},_buildShape:function(){if(this._interval=this._getInterval(),this.option.show){this.option.splitArea.show&&this._buildSplitArea(),this.option.splitLine.show&&this._buildSplitLine(),this.option.axisLine.show&&this._buildAxisLine(),this.option.axisTick.show&&this._buildAxisTick(),this.option.axisLabel.show&&this._buildAxisLabel();for(var e=0,t=this.shapeList.length;t>e;e++)this.zr.addShape(this.shapeList[e])}},_buildAxisTick:function(){var e,t=this.option.data,i=this.option.data.length,a=this.option.axisTick,r=a.length,o=a.lineStyle.color,n=a.lineStyle.width,l="function"==typeof a.interval?a.interval:"auto"==a.interval?"function"==typeof this.option.axisLabel.interval?this.option.axisLabel.interval:!1:!1,h=l?1:"auto"==a.interval?this._interval:a.interval-0+1,d=a.onGap,p=d?this.getGap()/2:"undefined"==typeof d?this.option.boundaryGap?this.getGap()/2:0:0,c=p>0?-h:0;if(this.isHorizontal())for(var u,g="bottom"==this.option.position?a.inside?this.grid.getYend()-r-1:this.grid.getYend()+1:a.inside?this.grid.getY()+1:this.grid.getY()-r-1,f=c;i>f;f+=h)if(!l||l(f,t[f]))u=this.subPixelOptimize(this.getCoordByIndex(f)+(f>=0?p:0),n),e={_axisShape:"axisTick",zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{xStart:u,yStart:g,xEnd:u,yEnd:g+r,strokeColor:o,lineWidth:n}},this.shapeList.push(new s(e));else;else for(var y,m="left"==this.option.position?a.inside?this.grid.getX()+1:this.grid.getX()-r-1:a.inside?this.grid.getXend()-r-1:this.grid.getXend()+1,f=c;i>f;f+=h)if(!l||l(f,t[f]))y=this.subPixelOptimize(this.getCoordByIndex(f)-(f>=0?p:0),n),e={_axisShape:"axisTick",zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{xStart:m,yStart:y,xEnd:m+r,yEnd:y,strokeColor:o,lineWidth:n}},this.shapeList.push(new s(e));else;},_buildAxisLabel:function(){var e,t,s=this.option.data,a=this.option.data.length,r=this.option.axisLabel,n=r.rotate,l=r.margin,h=r.clickable,d=r.textStyle,p="function"==typeof r.interval?r.interval:!1;if(this.isHorizontal()){var c,u;if("bottom"==this.option.position)c=this.grid.getYend()+l,u="top";else c=this.grid.getY()-l,u="bottom";for(var g=0;a>g;g+=this._interval)if((!p||p(g,s[g]))&&""!==this._getReformedLabel(g)){if(t=o.merge(s[g].textStyle||{},d),e={zlevel:this.getZlevelBase(),z:this.getZBase()+3,hoverable:!1,style:{x:this.getCoordByIndex(g),y:c,color:t.color,text:this._getReformedLabel(g),textFont:this.getFont(t),textAlign:t.align||"center",textBaseline:t.baseline||u}},n)e.style.textAlign=n>0?"bottom"==this.option.position?"right":"left":"bottom"==this.option.position?"left":"right",e.rotation=[n*Math.PI/180,e.style.x,e.style.y];this.shapeList.push(new i(this._axisLabelClickable(h,e)))}else;}else{var f,y;if("left"==this.option.position)f=this.grid.getX()-l,y="right";else f=this.grid.getXend()+l,y="left";for(var g=0;a>g;g+=this._interval)if((!p||p(g,s[g]))&&""!==this._getReformedLabel(g)){if(t=o.merge(s[g].textStyle||{},d),e={zlevel:this.getZlevelBase(),z:this.getZBase()+3,hoverable:!1,style:{x:f,y:this.getCoordByIndex(g),color:t.color,text:this._getReformedLabel(g),textFont:this.getFont(t),textAlign:t.align||y,textBaseline:t.baseline||0===g&&""!==this.option.name?"bottom":g==a-1&&""!==this.option.name?"top":"middle"}},n)e.rotation=[n*Math.PI/180,e.style.x,e.style.y];this.shapeList.push(new i(this._axisLabelClickable(h,e)))}else;}},_buildSplitLine:function(){var e,t=this.option.data,i=this.option.data.length,a=this.option.splitLine,r=a.lineStyle.type,o=a.lineStyle.width,n=a.lineStyle.color;n=n instanceof Array?n:[n];var l=n.length,h="function"==typeof this.option.axisLabel.interval?this.option.axisLabel.interval:!1,d=a.onGap,p=d?this.getGap()/2:"undefined"==typeof d?this.option.boundaryGap?this.getGap()/2:0:0;if(i-=d||"undefined"==typeof d&&this.option.boundaryGap?1:0,this.isHorizontal())for(var c,u=this.grid.getY(),g=this.grid.getYend(),f=0;i>f;f+=this._interval)if(!h||h(f,t[f]))c=this.subPixelOptimize(this.getCoordByIndex(f)+p,o),e={zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{xStart:c,yStart:u,xEnd:c,yEnd:g,strokeColor:n[f/this._interval%l],lineType:r,lineWidth:o}},this.shapeList.push(new s(e));else;else for(var y,m=this.grid.getX(),v=this.grid.getXend(),f=0;i>f;f+=this._interval)if(!h||h(f,t[f]))y=this.subPixelOptimize(this.getCoordByIndex(f)-p,o),e={zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{xStart:m,yStart:y,xEnd:v,yEnd:y,strokeColor:n[f/this._interval%l],lineType:r,lineWidth:o}},this.shapeList.push(new s(e));else;},_buildSplitArea:function(){var e,t=this.option.data,i=this.option.splitArea,s=i.areaStyle.color;if(!(s instanceof Array))e={zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this.grid.getX(),y:this.grid.getY(),width:this.grid.getWidth(),height:this.grid.getHeight(),color:s}},this.shapeList.push(new a(e));else{var r=s.length,o=this.option.data.length,n="function"==typeof this.option.axisLabel.interval?this.option.axisLabel.interval:!1,l=i.onGap,h=l?this.getGap()/2:"undefined"==typeof l?this.option.boundaryGap?this.getGap()/2:0:0;if(this.isHorizontal())for(var d,p=this.grid.getY(),c=this.grid.getHeight(),u=this.grid.getX(),g=0;o>=g;g+=this._interval)if(!(n&&!n(g,t[g])&&o>g))d=o>g?this.getCoordByIndex(g)+h:this.grid.getXend(),e={zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:u,y:p,width:d-u,height:c,color:s[g/this._interval%r]}},this.shapeList.push(new a(e)),u=d;else;else for(var f,y=this.grid.getX(),m=this.grid.getWidth(),v=this.grid.getYend(),g=0;o>=g;g+=this._interval)if(!(n&&!n(g,t[g])&&o>g))f=o>g?this.getCoordByIndex(g)-h:this.grid.getY(),e={zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:y,y:f,width:m,height:v-f,color:s[g/this._interval%r]}},this.shapeList.push(new a(e)),v=f;else;}},refresh:function(e){if(e)this.option=this.reformOption(e),this.option.axisLabel.textStyle=this.getTextStyle(this.option.axisLabel.textStyle);this.clear(),this._buildShape()},getGap:function(){var e=this.option.data.length,t=this.isHorizontal()?this.grid.getWidth():this.grid.getHeight();if(this.option.boundaryGap)return t/e;else return t/(e>1?e-1:1)},getCoord:function(e){for(var t=this.option.data,i=t.length,s=this.getGap(),a=this.option.boundaryGap?s/2:0,r=0;i>r;r++){if(this.getDataFromOption(t[r])==e){if(this.isHorizontal())a=this.grid.getX()+a;else a=this.grid.getYend()-a;return a}a+=s}},getCoordByIndex:function(e){if(0>e)if(this.isHorizontal())return this.grid.getX();else return this.grid.getYend();else if(e>this.option.data.length-1)if(this.isHorizontal())return this.grid.getXend();else return this.grid.getY();else{var t=this.getGap(),i=this.option.boundaryGap?t/2:0;if(i+=e*t,this.isHorizontal())i=this.grid.getX()+i;else i=this.grid.getYend()-i;return i}},getNameByIndex:function(e){return this.getDataFromOption(this.option.data[e])},getIndexByName:function(e){for(var t=this.option.data,i=t.length,s=0;i>s;s++)if(this.getDataFromOption(t[s])==e)return s;return-1},getValueFromCoord:function(){return""},isMainAxis:function(e){return e%this._interval===0}},o.inherits(e,t),require("../component").define("categoryAxis",e),e});