define("echarts/chart/line",["require","./base","zrender/shape/Polyline","../util/shape/Icon","../util/shape/HalfSmoothPolygon","../component/axis","../component/grid","../component/dataZoom","../config","../util/ecData","zrender/tool/util","zrender/tool/color","../chart"],function(require){function e(e,t,a,r,s){i.call(this,e,t,a,r,s),this.refresh(r)}function t(e,t,i){var a=t.x,s=t.y,o=t.width,n=t.height,l=n/2;if(t.symbol.match("empty"))e.fillStyle="#fff";t.brushType="both";var h=t.symbol.replace("empty","").toLowerCase();if(h.match("star"))l=h.replace("star","")-0||5,s-=1,h="star";else if("rectangle"===h||"arrow"===h)a+=(o-n)/2,o=n;var d="";if(h.match("image"))d=h.replace(new RegExp("^image:\\/\\/"),""),h="image",a+=Math.round((o-n)/2)-1,o=n+=2;if(h=r.prototype.iconLibrary[h]){var p=t.x,c=t.y;e.moveTo(p,c+l),e.lineTo(p+5,c+l),e.moveTo(p+t.width-5,c+l),e.lineTo(p+t.width,c+l);var u=this;h(e,{x:a+4,y:s+4,width:o-8,height:n-8,n:l,image:d},function(){u.modSelf(),i()})}else e.moveTo(a,s+l),e.lineTo(a+o,s+l)}var i=require("./base"),a=require("zrender/shape/Polyline"),r=require("../util/shape/Icon"),s=require("../util/shape/HalfSmoothPolygon");require("../component/axis"),require("../component/grid"),require("../component/dataZoom");var o=require("../config");o.line={zlevel:0,z:2,clickable:!0,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,itemStyle:{normal:{label:{show:!1},lineStyle:{width:2,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}},emphasis:{label:{show:!1}}},symbolSize:2,showAllSymbol:!1};var n=require("../util/ecData"),l=require("zrender/tool/util"),h=require("zrender/tool/color");return e.prototype={type:o.CHART_TYPE_LINE,_buildShape:function(){this.finalPLMap={},this._buildPosition()},_buildHorizontal:function(e,t,i,a){for(var r,s,o,n,l,h,d,p,c,u=this.series,g=i[0][0],f=u[g],y=this.component.xAxis.getAxis(f.xAxisIndex||0),m={},v=0,b=t;b>v&&null!=y.getNameByIndex(v);v++){s=y.getCoordByIndex(v);for(var x=0,_=i.length;_>x;x++){r=this.component.yAxis.getAxis(u[i[x][0]].yAxisIndex||0),l=n=d=h=r.getCoord(0);for(var S=0,C=i[x].length;C>S;S++)if(g=i[x][S],f=u[g],p=f.data[v],c=this.getDataFromOption(p,"-"),m[g]=m[g]||[],a[g]=a[g]||{min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,sum:0,counter:0,average:0},"-"!==c){if(c>=0)n-=S>0?r.getCoordSize(c):l-r.getCoord(c),o=n;else if(0>c)h+=S>0?r.getCoordSize(c):r.getCoord(c)-d,o=h;if(m[g].push([s,o,v,y.getNameByIndex(v),s,l]),a[g].min>c)a[g].min=c,a[g].minY=o,a[g].minX=s;if(a[g].max<c)a[g].max=c,a[g].maxY=o,a[g].maxX=s;a[g].sum+=c,a[g].counter++}else if(m[g].length>0)this.finalPLMap[g]=this.finalPLMap[g]||[],this.finalPLMap[g].push(m[g]),m[g]=[]}n=this.component.grid.getY();for(var z,x=0,_=i.length;_>x;x++)for(var S=0,C=i[x].length;C>S;S++)if(g=i[x][S],f=u[g],p=f.data[v],c=this.getDataFromOption(p,"-"),"-"==c){if(this.deepQuery([p,f,this.option],"calculable"))z=this.deepQuery([p,f],"symbolSize"),n+=2*z+5,o=n,this.shapeList.push(this._getCalculableItem(g,v,y.getNameByIndex(v),s,o,"horizontal"))}else;}for(var L in m)if(m[L].length>0)this.finalPLMap[L]=this.finalPLMap[L]||[],this.finalPLMap[L].push(m[L]),m[L]=[];this._calculMarkMapXY(a,i,"y"),this._buildBorkenLine(e,this.finalPLMap,y,"horizontal")},_buildVertical:function(e,t,i,a){for(var r,s,o,n,l,h,d,p,c,u=this.series,g=i[0][0],f=u[g],y=this.component.yAxis.getAxis(f.yAxisIndex||0),m={},v=0,b=t;b>v&&null!=y.getNameByIndex(v);v++){o=y.getCoordByIndex(v);for(var x=0,_=i.length;_>x;x++){r=this.component.xAxis.getAxis(u[i[x][0]].xAxisIndex||0),l=n=d=h=r.getCoord(0);for(var S=0,C=i[x].length;C>S;S++)if(g=i[x][S],f=u[g],p=f.data[v],c=this.getDataFromOption(p,"-"),m[g]=m[g]||[],a[g]=a[g]||{min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY,sum:0,counter:0,average:0},"-"!==c){if(c>=0)n+=S>0?r.getCoordSize(c):r.getCoord(c)-l,s=n;else if(0>c)h-=S>0?r.getCoordSize(c):d-r.getCoord(c),s=h;if(m[g].push([s,o,v,y.getNameByIndex(v),l,o]),a[g].min>c)a[g].min=c,a[g].minX=s,a[g].minY=o;if(a[g].max<c)a[g].max=c,a[g].maxX=s,a[g].maxY=o;a[g].sum+=c,a[g].counter++}else if(m[g].length>0)this.finalPLMap[g]=this.finalPLMap[g]||[],this.finalPLMap[g].push(m[g]),m[g]=[]}n=this.component.grid.getXend();for(var z,x=0,_=i.length;_>x;x++)for(var S=0,C=i[x].length;C>S;S++)if(g=i[x][S],f=u[g],p=f.data[v],c=this.getDataFromOption(p,"-"),"-"==c){if(this.deepQuery([p,f,this.option],"calculable"))z=this.deepQuery([p,f],"symbolSize"),n-=2*z+5,s=n,this.shapeList.push(this._getCalculableItem(g,v,y.getNameByIndex(v),s,o,"vertical"))}else;}for(var L in m)if(m[L].length>0)this.finalPLMap[L]=this.finalPLMap[L]||[],this.finalPLMap[L].push(m[L]),m[L]=[];this._calculMarkMapXY(a,i,"x"),this._buildBorkenLine(e,this.finalPLMap,y,"vertical")},_buildOther:function(e,t,i,a){for(var r,s=this.series,o={},n=0,l=i.length;l>n;n++)for(var h=0,d=i[n].length;d>h;h++){var p=i[n][h],c=s[p];r=this.component.xAxis.getAxis(c.xAxisIndex||0);var u=this.component.yAxis.getAxis(c.yAxisIndex||0),g=u.getCoord(0);o[p]=o[p]||[],a[p]=a[p]||{min0:Number.POSITIVE_INFINITY,min1:Number.POSITIVE_INFINITY,max0:Number.NEGATIVE_INFINITY,max1:Number.NEGATIVE_INFINITY,sum0:0,sum1:0,counter0:0,counter1:0,average0:0,average1:0};for(var f=0,y=c.data.length;y>f;f++){var m=c.data[f],v=this.getDataFromOption(m,"-");if(v instanceof Array){var b=r.getCoord(v[0]),x=u.getCoord(v[1]);if(o[p].push([b,x,f,v[0],b,g]),a[p].min0>v[0])a[p].min0=v[0],a[p].minY0=x,a[p].minX0=b;if(a[p].max0<v[0])a[p].max0=v[0],a[p].maxY0=x,a[p].maxX0=b;if(a[p].sum0+=v[0],a[p].counter0++,a[p].min1>v[1])a[p].min1=v[1],a[p].minY1=x,a[p].minX1=b;if(a[p].max1<v[1])a[p].max1=v[1],a[p].maxY1=x,a[p].maxX1=b;a[p].sum1+=v[1],a[p].counter1++}else;}}for(var _ in o)if(o[_].length>0)this.finalPLMap[_]=this.finalPLMap[_]||[],this.finalPLMap[_].push(o[_]),o[_]=[];this._calculMarkMapXY(a,i,"xy"),this._buildBorkenLine(e,this.finalPLMap,r,"other")},_buildBorkenLine:function(e,t,i,r){for(var o,d="other"==r?"horizontal":r,p=this.series,c=e.length-1;c>=0;c--){var u=e[c],g=p[u],f=t[u];if(g.type===this.type&&null!=f)for(var y=this._getBbox(u,d),m=this._sIndex2ColorMap[u],v=this.query(g,"itemStyle.normal.lineStyle.width"),b=this.query(g,"itemStyle.normal.lineStyle.type"),x=this.query(g,"itemStyle.normal.lineStyle.color"),_=this.getItemStyleColor(this.query(g,"itemStyle.normal.color"),u,-1),S=null!=this.query(g,"itemStyle.normal.areaStyle"),C=this.query(g,"itemStyle.normal.areaStyle.color"),z=0,L=f.length;L>z;z++){var M=f[z],w="other"!=r&&this._isLarge(d,M);if(!w){for(var k=0,A=M.length;A>k;k++)if(o=g.data[M[k][2]],this.deepQuery([o,g,this.option],"calculable")||this.deepQuery([o,g],"showAllSymbol")||"categoryAxis"===i.type&&i.isMainAxis(M[k][2])&&"none"!=this.deepQuery([o,g],"symbol"))this.shapeList.push(this._getSymbol(u,M[k][2],M[k][3],M[k][0],M[k][1],d))}else M=this._getLargePointList(d,M);var I=new a({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{miterLimit:v,pointList:M,strokeColor:x||_||m,lineWidth:v,lineType:b,smooth:this._getSmooth(g.smooth),smoothConstraint:y,shadowColor:this.query(g,"itemStyle.normal.lineStyle.shadowColor"),shadowBlur:this.query(g,"itemStyle.normal.lineStyle.shadowBlur"),shadowOffsetX:this.query(g,"itemStyle.normal.lineStyle.shadowOffsetX"),shadowOffsetY:this.query(g,"itemStyle.normal.lineStyle.shadowOffsetY")},hoverable:!1,_main:!0,_seriesIndex:u,_orient:d});if(n.pack(I,p[u],u,0,z,p[u].name),this.shapeList.push(I),S){var T=new s({zlevel:this.getZlevelBase(),z:this.getZBase(),style:{miterLimit:v,pointList:l.clone(M).concat([[M[M.length-1][4],M[M.length-1][5]],[M[0][4],M[0][5]]]),brushType:"fill",smooth:this._getSmooth(g.smooth),smoothConstraint:y,color:C?C:h.alpha(m,.5)},highlightStyle:{brushType:"fill"},hoverable:!1,_main:!0,_seriesIndex:u,_orient:d});n.pack(T,p[u],u,0,z,p[u].name),this.shapeList.push(T)}}}},_getBbox:function(e,t){var i=this.component.grid.getBbox(),a=this.xMarkMap[e];if(null!=a.minX0)return[[Math.min(a.minX0,a.maxX0,a.minX1,a.maxX1),Math.min(a.minY0,a.maxY0,a.minY1,a.maxY1)],[Math.max(a.minX0,a.maxX0,a.minX1,a.maxX1),Math.max(a.minY0,a.maxY0,a.minY1,a.maxY1)]];else if("horizontal"===t)i[0][1]=Math.min(a.minY,a.maxY),i[1][1]=Math.max(a.minY,a.maxY);else i[0][0]=Math.min(a.minX,a.maxX),i[1][0]=Math.max(a.minX,a.maxX);return i},_isLarge:function(e,t){if(t.length<2)return!1;else return"horizontal"===e?Math.abs(t[0][0]-t[1][0])<.5:Math.abs(t[0][1]-t[1][1])<.5},_getLargePointList:function(e,t){var i;if("horizontal"===e)i=this.component.grid.getWidth();else i=this.component.grid.getHeight();for(var a=t.length,r=[],s=0;i>s;s++)r[s]=t[Math.floor(a/i*s)];return r},_getSmooth:function(e){if(e)return.3;else return 0},_getCalculableItem:function(e,t,i,a,r,s){var n=this.series,l=n[e].calculableHolderColor||this.ecTheme.calculableHolderColor||o.calculableHolderColor,h=this._getSymbol(e,t,i,a,r,s);return h.style.color=l,h.style.strokeColor=l,h.rotation=[0,0],h.hoverable=!1,h.draggable=!1,h.style.text=void 0,h},_getSymbol:function(e,t,i,a,r,s){var o=this.series,n=o[e],l=n.data[t],h=this.getSymbolShape(n,e,l,t,i,a,r,this._sIndex2ShapeMap[e],this._sIndex2ColorMap[e],"#fff","vertical"===s?"horizontal":"vertical");if(h.zlevel=this.getZlevelBase(),h.z=this.getZBase()+1,this.deepQuery([l,n,this.option],"calculable"))this.setCalculable(h),h.draggable=!0;return h},getMarkCoord:function(e,t){var i=this.series[e],a=this.xMarkMap[e],r=this.component.xAxis.getAxis(i.xAxisIndex),s=this.component.yAxis.getAxis(i.yAxisIndex);if(t.type&&("max"===t.type||"min"===t.type||"average"===t.type)){var o=null!=t.valueIndex?t.valueIndex:null!=a.maxX0?"1":"";return[a[t.type+"X"+o],a[t.type+"Y"+o],a[t.type+"Line"+o],a[t.type+o]]}return["string"!=typeof t.xAxis&&r.getCoordByIndex?r.getCoordByIndex(t.xAxis||0):r.getCoord(t.xAxis||0),"string"!=typeof t.yAxis&&s.getCoordByIndex?s.getCoordByIndex(t.yAxis||0):s.getCoord(t.yAxis||0)]},refresh:function(e){if(e)this.option=e,this.series=e.series;this.backupShapeList(),this._buildShape()},ontooltipHover:function(e,t){for(var i,a,r=e.seriesIndex,s=e.dataIndex,o=r.length;o--;)if(i=this.finalPLMap[r[o]])for(var n=0,l=i.length;l>n;n++){a=i[n];for(var h=0,d=a.length;d>h;h++)if(s===a[h][2])t.push(this._getSymbol(r[o],a[h][2],a[h][3],a[h][0],a[h][1],"horizontal"))}},addDataAnimation:function(e,t){function i(){if(f--,0===f)t&&t()}function a(e){e.style.controlPointList=null}for(var r=this.series,s={},o=0,n=e.length;n>o;o++)s[e[o][0]]=e[o];for(var l,h,d,p,c,u,g,f=0,o=this.shapeList.length-1;o>=0;o--)if(c=this.shapeList[o]._seriesIndex,s[c]&&!s[c][3]){if(this.shapeList[o]._main&&this.shapeList[o].style.pointList.length>1){if(u=this.shapeList[o].style.pointList,h=Math.abs(u[0][0]-u[1][0]),p=Math.abs(u[0][1]-u[1][1]),g="horizontal"===this.shapeList[o]._orient,s[c][2]){if("half-smooth-polygon"===this.shapeList[o].type){var y=u.length;this.shapeList[o].style.pointList[y-3]=u[y-2],this.shapeList[o].style.pointList[y-3][g?0:1]=u[y-4][g?0:1],this.shapeList[o].style.pointList[y-2]=u[y-1]}this.shapeList[o].style.pointList.pop(),g?(l=h,d=0):(l=0,d=-p)}else{if(this.shapeList[o].style.pointList.shift(),"half-smooth-polygon"===this.shapeList[o].type){var m=this.shapeList[o].style.pointList.pop();g?m[0]=u[0][0]:m[1]=u[0][1],this.shapeList[o].style.pointList.push(m)}g?(l=-h,d=0):(l=0,d=p)}this.shapeList[o].style.controlPointList=null,this.zr.modShape(this.shapeList[o])}else if(s[c][2]&&this.shapeList[o]._dataIndex===r[c].data.length-1){this.zr.delShape(this.shapeList[o].id);continue}else if(!s[c][2]&&0===this.shapeList[o]._dataIndex){this.zr.delShape(this.shapeList[o].id);continue}this.shapeList[o].position=[0,0],f++,this.zr.animate(this.shapeList[o].id,"").when(this.query(this.option,"animationDurationUpdate"),{position:[l,d]}).during(a).done(i).start()}if(!f)i()}},r.prototype.iconLibrary.legendLineIcon=t,l.inherits(e,i),require("../chart").define("line",e),e});