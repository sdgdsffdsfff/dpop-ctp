define("ub-ria/mvc/ListView",["require","./BaseView","er/util","underscore","../util"],function(require){function e(){m.apply(this,arguments);var e={pager:{pagesizechange:i,pagechange:n},table:{select:"updateBatchButtonStatus",sort:t},"filter:submit":"submitSearch","filter-switch:click":r,"filter-cancel:click":l,"filter-modify:click":h};this.addUIEvents(e);var a={table:{fields:this.getTableFields()}};this.addUIProperties(a)}function t(e){var t={order:e.order,orderBy:e.field.field};this.sortTable(t)}function i(e){var t=e.target.get("pageSize");this.updatePageSize(t)}function n(){this.updatePageIndex()}function a(e){var t={status:+e.target.getData("status")};this.fire("batchmodify",t)}function r(){var e=this.getSafely("filter");e.isHidden()?o.call(this):l.call(this)}function o(){this.getSafely("filter").show(),this.getSafely("filter-switch").addState("expand")}function s(){this.getSafely("filter").hide(),this.getSafely("filter-switch").removeState("expand")}function l(){if(this.model.get("filtersInfo").isAllFiltersDefault)s.call(this);else this.submitSearchWithoutKey()}function h(){this.getGroup("filter-content").toggle()}function d(e){var t=this.model.defaultArgs[e]||"";this.get(e).setValue(t)}var m=require("./BaseView"),u=require("er/util"),c=require("underscore");return u.inherits(e,m),e.prototype.submitSearch=function(){this.fire("search")},e.prototype.sortTable=function(e){this.fire("tablesort",{tableProperties:e})},e.prototype.updateBatchButtonStatus=function(){var e=this.getSelectedItems();c.each(this.getGroup("batch"),function(t){var i=+t.getData("status"),n=c.isEmpty(e)||!this.model.canUpdateToStatus(e,i);t.set("disabled",n)},this)},e.prototype.updateFilterPanelStatus=function(){if(!this.model.get("filtersInfo").isAllFiltersDefault)o.call(this),h.call(this)},e.prototype.updateSearchBoxStatus=function(){if(this.model.get("keyword"))this.getSafely("keyword").addState("clear")},e.prototype.getSelectedItems=function(){var e=this.get("table");return e?e.getSelectedItems():[]},e.prototype.getSearchArgs=function(){var e=this.get("filter"),t=e?e.getData():{};t.order=this.get("table").order,t.orderBy=this.get("table").orderBy;var i=this.get("keyword");if(i)t.keyword=require("../util").trim(i.getValue());return t},e.prototype.tableFields=[],e.prototype.getTableFields=function(){return this.tableFields},e.prototype.getPageIndex=function(){return this.get("pager").get("page")},e.prototype.updatePageSize=function(e){this.fire("pagesizechange",{pageSize:e})},e.prototype.updatePageIndex=function(){this.fire("pagechange")},e.prototype.bindEvents=function(){this.getGroup("batch").each(function(e){e.on("click",a,this)},this),this.getGroup("clear-button").each(function(e){var t=e.get("name");e.on("click",function(){this.submitSearchWithoutKey(t)},this)},this),m.prototype.bindEvents.apply(this,arguments)},e.prototype.submitSearchWithoutKey=function(e){if(e)d.call(this,e);else{var t=this;this.getGroup("clear-button").each(function(e){var i=e.get("name");d.call(t,i)})}this.fire("search")},e.prototype.enterDocument=function(){m.prototype.enterDocument.apply(this,arguments),this.updateBatchButtonStatus(),this.updateFilterPanelStatus(),this.updateSearchBoxStatus()},e.prototype.adjustLayout=function(){var e=this.get("table");if(e)e.adjustWidth()},e});