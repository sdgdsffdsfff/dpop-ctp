define("ub-ria/mvc/FormModel",["require","er/util","./SingleEntityModel","er/Deferred"],function(require){function e(){n.apply(this,arguments)}var t=require("er/util"),n=require("./SingleEntityModel"),i=require("er/Deferred");return t.inherits(e,n),e.prototype.fillEntity=function(e){return e},e.prototype.setValidator=function(e){if(e)e.setRule(this.get("rule"));this.validator=e},e.prototype.getValidator=function(){return this.validator},e.prototype.validateEntity=function(e){var t=this.getValidator();if(!t)throw new Error("No validator object attached to this Model");return t.validate(e)},e.prototype.save=function(e){var t=this.data();if(!t)throw new Error("No default data object attached to this Model");if("function"!=typeof t.save)throw new Error("No save method implemented on default data object");e=this.fillEntity(e);var n=this.validateEntity(e);if(n.length>0)return i.rejected({fields:n});else return t.save(e)},e.prototype.update=function(e){var t=this.data();if(!t)throw new Error("No default data object attached to this Model");if("function"!=typeof t.update)throw new Error("No update method implemented on default data object");e=this.fillEntity(e),e.id=this.get("id");var n=this.validateEntity(e);if(n.length>0)return i.rejected({fields:n});else return t.update(e)},e});