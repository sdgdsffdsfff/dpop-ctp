define("ub-ria/ui/AbstractBoxGroup",["require","underscore","esui/lib","esui/InputControl","esui/painters","esui/main"],function(require){function e(){d.apply(this,arguments)}function t(e){return i(e,"value")}function i(e,t){return e.getAttribute("data-ui-"+t)}function n(e,t,i){e.setAttribute("data-ui-"+t,i)}function a(e){return"checked"===i(e,"checked")}function r(e,n){for(var r=e.children,o=[],s=[],l=n.boxType,h=0,d=r.length;d>h;h++){var m=r[h];if(i(m,"box-type")===l)o.push({value:t(m),text:m.innerHTML||i(m,"text")});if(a(m))s.push(m.value)}if(n.datasource=o,!n.rawValue&&!n.value)n.rawValue=s}function o(e){if(!this.disabled&&!this.readOnly){var i=e.target,n="radio"===this.boxType?[]:l.clone(this.rawValue),a=t(i);if(l.contains(n,a))n=l.without(n,a);else n.push(a);this.set("rawValue",n)}}function s(e,t,i){e.helper.clearDOMEvents();for(var n="",a=e.helper.getPartClasses("wrapper"),r=h.toDictionary(e.rawValue),s=0;s<t.length;s++){var d=t[s],u={wrapperClass:a.concat(e.helper.getPartClasses("wrapper-"+s)).join(" "),id:e.helper.getId("box-"+s),boxType:e.boxType,text:h.trim(d.text),value:d.value,checked:r[d.value]?' data-ui-checked="checked"':"",className:e.helper.getPartClasses(i).join(" ")};n+=h.format(m,u)}e.main.innerHTML=n,l.each(e.getBoxElements(),function(e){this.helper.addDOMEvent(e,"click",o)},e)}var l=require("underscore"),h=require("esui/lib"),d=require("esui/InputControl");e.prototype.type="AbstractBoxGroup",e.prototype.initOptions=function(e){var t={datasource:[],orientation:"horizontal",boxType:"radio"};if(l.extend(t,e),!t.datasource.length)r(this.main,t);if(!t.rawValue&&!t.value)t.rawValue=[];this.setProperties(t)};var m=['<div class="${wrapperClass}">','<div id="${id}" class="${className}" ${checked}','   data-ui-value="${value}" data-ui-box-type="${boxType}">',"${text}</div>","</div>"];return m=m.join(""),e.prototype.setProperties=function(e){if(!(!e.datasource&&!e.boxType||e.rawValue||e.value||this.rawValue&&this.rawValue.length))e.rawValue=[];var t=d.prototype.setProperties.apply(this,arguments);if(t.hasOwnProperty("rawValue"))this.fire("change")},e.prototype.repaint=require("esui/painters").createRepaint(d.prototype.repaint,{name:["datasource","boxType"],paint:s},{name:"rawValue",paint:function(e,i){i=i||[],e.rawValue=i;var r={};l.each(i,function(e){r[e]=!0}),l.each(e.getBoxElements(),function(i){n(i,"checked",r[t(i)]?"checked":"");var o=e.helper.getPartClasses("wrapper-checked")[0];if(a(i))h.addClass(i.parentNode,o);else h.removeClass(i.parentNode,o)})}},{name:"orientation",paint:function(e,t){e.removeState("vertical"),e.removeState("horizontal"),e.addState(t)}}),e.prototype.parseValue=function(e){return e.split(",")},e.prototype.getBoxElements=function(){var e=this.boxType;return l.filter(this.main.getElementsByTagName("div"),function(t){return i(t,"box-type")===e})},h.inherits(e,d),require("esui/main").register(e),e});