define("esui/helper/event",["require","underscore","mini-event/EventQueue","../lib","mini-event"],function(require){function e(e){if(e===window)return s.window;if(e===document)return s.document;if(e===document.documentElement)return s.documentElement;if(e===document.body)return s.body;else return null}function t(t,i){var n=e(t);if(n){var a=n[i.type];if(a)l.each(a,function(e){o(e,t,i)})}}function i(e,t){t=t||150;var i=0;return function(n){clearTimeout(i);var a=this;n=n||window.event,n={type:n.type,srcElement:n.srcElement,target:n.target,currentTarget:n.currentTarget},i=setTimeout(function(){e.call(a,n)},t)}}function n(n,a,o){var r=e(o);if(!r)return!1;var s=r[a];if(!s){s=r[a]=[];var h=l.partial(t,o);if("resize"===a||"scroll"===a)h=i(h);s.handler=h,m.on(o,a,s.handler)}if(!(l.indexOf(s,n)>=0))return s.push(n),!0}function a(t,i,n){var a=e(n);if(!a)return!1;if(!a[i])return!0;for(var o=a[i],r=0;r<o.length;r++)if(o[r]===t){o.splice(r,1);break}if(!o.length){var s=o.handler;m.un(n,i,s),a[i]=null}return!0}function o(e,t,i){i=i||window.event;var n=l.any(e.ignoreStates,function(t){return e.hasState(t)});if(!n){if(!i.target)i.target=i.srcElement;if(!i.currentTarget)i.currentTarget=t;if(!i.preventDefault)i.preventDefault=function(){i.returnValue=!1};if(!i.stopPropagation)i.stopPropagation=function(){i.cancelBubble=!0};var a=e.domEvents[i.currentTarget[r]][i.type];if(a)a.execute(i,e)}}var r="_esuiDOMEvent",s={window:{},document:{},documentElement:{},body:{}},l=require("underscore"),h=require("mini-event/EventQueue"),m=require("../lib"),V={};return V.addDOMEvent=function(e,t,i){if("string"==typeof e)e=this.getPart(e);if(!this.control.domEvents)this.control.domEvents={};var a=e[r];if(!a)a=e[r]=m.getGUID();var s=this.control.domEvents[a];if(!s)s=this.control.domEvents[a]={element:e};var V=n(this.control,t,e),U=s[t];if(!U)if(U=s[t]=new h,!V)U.handler=l.partial(o,this.control,e),m.on(e,t,U.handler);U.add(i)},V.delegateDOMEvent=function(e,t,i){var n=function(e){var t=require("mini-event").fromDOMEvent(e);if(this.fire(i||e.type,t),t.isDefaultPrevented())m.event.preventDefault(e);if(t.isPropagationStopped())m.event.stopPropagation(e)};this.addDOMEvent(e,t,n)},V.removeDOMEvent=function(e,t,i){if("string"==typeof e)e=this.getPart(e);if(this.control.domEvents){var n=e[r],o=this.control.domEvents[n];if(o&&o[t])if(!i)o[t].clear();else{var s=o[t];if(s.remove(i),!s.getLength())a(this.control,t,e)}}},V.clearDOMEvents=function(e){if("string"==typeof e)e=this.getPart(e);if(this.control.domEvents){if(!e)return l.each(l.pluck(this.control.domEvents,"element"),this.clearDOMEvents,this),void(this.control.domEvents=null);var t=e[r],i=this.control.domEvents[t];delete i.element,l.each(i,function(t,i){var n=a(this.control,i,e);if(!n){var o=t.handler;t.dispose(),t.handler=null,m.un(e,i,o)}},this),delete this.control.domEvents[t]}},V});