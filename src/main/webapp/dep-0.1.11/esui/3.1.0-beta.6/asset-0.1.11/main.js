define("esui/main",["require","./lib","./ViewContext","./ControlCollection"],function(require){function e(e,t){if("function"==typeof e){var i=e.prototype.type;if(i in t)throw new Error(i+" is exists!");t[i]=e}}function t(e,t,i){var n=i[e];if(n)return delete t.type,new n(t);else return null}var i=require("./lib"),n={};n.version="3.1.0-beta.6";var a=require("./ViewContext"),o=new a("default");n.getViewContext=function(){return o};var r={uiPrefix:"data-ui",extensionPrefix:"data-ui-extension",customElementPrefix:"esui",instanceAttr:"data-ctrl-id",viewContextAttr:"data-ctrl-view-context",uiClassPrefix:"ui",skinClassPrefix:"skin",stateClassPrefix:"state"};n.config=function(e){i.extend(r,e)},n.getConfig=function(e){return r[e]},n.parseAttribute=function(e,t){if(!e)return{};for(var n={},a=0,o=0;o<e.length;){for(;o<e.length&&":"!==e.charAt(o);)o++;if(o>=e.length)break;var r=i.trim(e.slice(a,o));for(o++,a=o;o<e.length&&";"!==e.charAt(o);)o++;for(var s=o+1;s<e.length;){var l=e.charAt(s);if(";"===l)o=s;if(":"===l)break;s++}var h=i.trim(e.slice(a,o));n[r]=t?t(h):h,o++,a=o}return n},n.getControlByDOM=function(e){if(!e)return null;var t,i=n.getConfig,o=e.getAttribute(i("instanceAttr")),r=e.getAttribute(i("viewContextAttr"));if(o&&r&&(t=a.get(r)))return t.get(o);else return null};var s={};n.register=function(t){e(t,s)},n.create=function(e,i){return t(e,i,s)},n.get=function(e){return o.get(e)},n.getSafely=function(e){return o.getSafely(e)};var l=require("./ControlCollection");n.wrap=function(){for(var e=new l,t=0;t<arguments.length;t++)e.add(arguments[t]);return e},n.init=function(e,t){function i(e){function t(e){return e.toUpperCase()}for(var i=1,n=e.length;n>i;i++)e[i]=e[i].replace(/^[a-z]/,t);return e.join("")}function a(e,t){for(var i in t)if(!(i in e))e[i]=t[i]}function o(e,t,o){if(0===t.length)a(e,n.parseAttribute(o,s));else e[i(t)]=s(o)}e=e||document.body,t=t||{};for(var s=t.valueReplacer||function(e){return e},l=e.getElementsByTagName("*"),h=[],m=0,V=l.length;V>m;m++)if(1===l[m].nodeType)h.push(l[m]);for(var U=n.getConfig("uiPrefix"),d=n.getConfig("extensionPrefix"),c=n.getConfig("customElementPrefix"),p=U.length,u=d.length,f=t.properties||{},y=[],m=0,V=h.length;V>m;m++){var g=h[m];if(!g.getAttribute(r.instanceAttr)){for(var b=g.attributes,k={},x={},L=0,_=b.length;_>L;L++){var W=b[L],X=W.name,v=W.value;if(0===X.indexOf(d)){var w=X.slice(u+1).split("-"),K=w[0];w.shift();var I=x[K];if(!I)I=x[K]={};o(I,w,v)}else if(0===X.indexOf(U)){var w=X.length===p?[]:X.slice(p+1).split("-");o(k,w,v)}}var C=k.type;if(!C){var J=g.nodeName.toLowerCase(),S=J.indexOf(c);if(0===S){var E;E=J.replace(/-(\S)/g,function(e,t){return t.toUpperCase()}),E=E.slice(c.length),k.type=E,C=E}}if(C){var A=k.id,T=A?f[A]:{};for(var F in T)k[F]=s(T[F]);var P=k.extensions||[];k.extensions=P;for(var F in x){var I=x[F],O=n.createExtension(I.type,I);O&&P.push(O)}k.viewContext=t.viewContext,k.renderOptions=t,k.main=g;var M=n.create(C,k);if(M){if(y.push(M),t.parent)t.parent.addChild(M);try{M.render()}catch(z){var D=new Error('Render control "'+(M.id||"anonymous")+'" of type '+M.type+" failed because: "+z.message);throw D.actualError=z,D}}}}else;}return y};var h={};n.registerExtension=function(t){e(t,h)},n.createExtension=function(e,i){return t(e,i,h)};var m={};n.attachExtension=function(e,t){m[e]=t},n.createGlobalExtensions=function(){var e=[];for(var t in m)if(m.hasOwnProperty(t)){var i=n.createExtension(t,m[t]);i&&e.push(i)}return e};var V=[];return n.registerRule=function(e,t){V.push({type:e,priority:t}),V.sort(function(e,t){return e.priority-t.priority})},n.createRulesByControl=function(e){for(var t=[],i=0;i<V.length;i++){var n=V[i].type;if(null!=e.get(n.prototype.type))t.push(new n)}return t},n}),define("esui",["esui/main"],function(e){return e});