define("esui/BoxGroup",["require","underscore","./lib","./InputControl","./painters","./main"],function(require){function e(){s.apply(this,arguments)}function t(e,t){for(var n=e.getElementsByTagName("input"),i=e.getElementsByTagName("label"),a={},o=i.length-1;o>=0;o--){var s=i[o],l=r.getAttribute(s,"for");if(l)a[l]=s}for(var h=[],V=[],o=0,m=n.length;m>o;o++){var U=n[o];if(U.type===t.boxType&&(t.name||"")===U.name){var p={value:U.value},s=U.id&&a[U.id];if(p.title=s?r.getText(s):"",!p.title)p.title=U.title||("on"===U.value?U.value:"");if(h.push(p),null!==U.getAttribute("checked"))V.push(U.value)}}if(t.datasource=h,!t.rawValue&&!t.value)t.rawValue=V}function n(e){var t=e.parentNode,n=this.helper.getPartClasses("wrapper-checked");if(e.checked)r.addClasses(t,n);else r.removeClasses(t,n)}function i(){o.each(this.getBoxElements(),n,this);var e=o.chain(this.getBoxElements()).where({checked:!0}).pluck("value").value();this.rawValue=e,this.fire("change")}function a(e,t,n){e.helper.clearDOMEvents();for(var a="",s=[].concat(e.helper.getPartClasses(n),e.helper.getPartClasses("wrapper")),h=r.toDictionary(e.rawValue),V=e.name||r.getGUID(),m=0;m<t.length;m++){var U=t[m],p="";if(h[U.value])p+=" "+e.helper.getPartClassName("wrapper-checked");var d={wrapperClass:s.join(" ")+p,id:e.helper.getId("box-"+m),type:e.boxType,name:V,title:r.trim(U.title||U.name||U.text),value:U.value,checked:h[U.value]?' checked="checked"':""};a+=r.format(l,d)}e.main.innerHTML=a;var c=e.main.addEventListener?"change":"click";o.each(e.getBoxElements(),function(e){this.helper.addDOMEvent(e,c,i)},e)}var o=require("underscore"),r=require("./lib"),s=require("./InputControl");e.prototype.type="BoxGroup",e.prototype.initOptions=function(e){var n={datasource:[],orientation:"horizontal",boxType:"radio"};o.extend(n,e);var i=n.datasource;if(!i.length)t(this.main,n);if(!n.hasOwnProperty("rawValue")&&!n.hasOwnProperty("value"))if("radio"===n.boxType&&i.length)n.rawValue=[i[0].value];else n.rawValue=[];this.setProperties(n)};var l=['<label title="${title}" class="${wrapperClass}">','    <input type="${type}" name="${name}" id="${id}" title="${title}" value="${value}"${checked} />',"    <span>${title}</span>","</label>"];return l=l.join(""),e.prototype.setProperties=function(e){if(!(!e.datasource&&!e.boxType||e.rawValue||e.value||this.rawValue&&this.rawValue.length))e.rawValue=[];var t=s.prototype.setProperties.apply(this,arguments);if(t.hasOwnProperty("rawValue"))this.fire("change")},e.prototype.repaint=require("./painters").createRepaint(s.prototype.repaint,{name:["datasource","boxType"],paint:a},{name:["disabled","readOnly"],paint:function(e,t,n){o.each(e.getBoxElements(),function(e){e.disabled=t,e.readOnly=n})}},{name:"rawValue",paint:function(e,t){t=t||[],e.rawValue=t;for(var i={},a=0;a<t.length;a++)i[t[a]]=!0;o.each(e.getBoxElements(),function(t){t.checked=i.hasOwnProperty(t.value),n.call(e,t)})}},{name:"orientation",paint:function(e,t){e.removeState("vertical"),e.removeState("horizontal"),e.addState(t)}}),e.prototype.parseValue=function(e){return e.split(",")},e.prototype.getBoxElements=function(){return o.where(this.main.getElementsByTagName("input"),{type:this.boxType})},r.inherits(e,s),require("./main").register(e),e});